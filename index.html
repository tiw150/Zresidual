<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Z-residual for Regression Modelling • Zresidual</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Z-residual for Regression Modelling">
<meta property="og:description" content="This package provides functions for computing and analyzing Z-residuals and cross-validatory Z-residuals from fitting outputs of several R packages, including coxph, survreg, glmmTMB, ...">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">Zresidual</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tiw150/Zresidual/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="z-residual">Z-residual<a class="anchor" aria-label="anchor" href="#z-residual"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The Z-residual is residual diagnosis tool for diagnosing survival models and generalized linear models.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of this package from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tiw150/Zresidual"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Li, L., Wu, T., Feng, C., 2021. Model Diagnostics for Censored Regression via Randomized Survival Probabilities. Statistics in Medicine, 2020+. <a href="https://doi.org/10.1002/sim.8852" class="external-link uri">https://doi.org/10.1002/sim.8852</a>; <a href="https://onlinelibrary.wiley.com/share/author/F8DKBTX7IT7UT2WTSZP3?target=10.1002/sim.8852" class="external-link uri">https://onlinelibrary.wiley.com/share/author/F8DKBTX7IT7UT2WTSZP3?target=10.1002/sim.8852</a></p>
<p>Wu, T., Li, L., &amp; Feng, C. (2023). Z-residual diagnostics for detecting misspecification of the functional form of covariates for shared frailty models. arXiv, page 2302.09106, 2023. Under review by Journal of Applied Statistics. <a href="https://arxiv.org/abs/2302.09106" class="external-link uri">https://arxiv.org/abs/2302.09106</a></p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This example provides a fundamental illustration of using the Z-residuals for diagnosing both the overall goodness of fit (GOF) and the functional form of covariates in a real application for modelling the survival times of acute myeloid leukemia patients.</p>
<p>The dataset employed in our analysis contains 411 patients who were recorded at the M. D. Anderson Cancer Center between 1980 and 1996. These patients were under the age of 60 and hailed from 24 administrative districts. The data collected information on the survival time for acute myeloid leukemia and prognostic factors, including age, sex, white blood cell count (wbc) at diagnosis, and the townsend score (tpi) for which higher values indicate less affluent areas. The censoring rate is 29.2%. The response variable of interest is the survival time in days, which is the time from entry to the study or death. The preliminary study showed that the wbc is highly right-skewed. Logarithm transformation is often used to reduce the impact of extremely large values of the covariate on the response variable, such as the wbc variable in this application. However, a logarithm transformation may mask the impact of extremely large values of the covariate on the outcome variable.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tiw150/Zresidual" class="external-link">Zresidual</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'Zresidual'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     residuals</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexkowa/EnvStats" class="external-link">EnvStats</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'EnvStats'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     predict, predict.lm</span></span>
<span><span class="co">## basic example code</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"LeukSurv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">LeukSurv</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time cens    xcoord    ycoord age sex   wbc   tpi district</span></span>
<span><span class="co">#&gt; 1    1    1 0.2050717 0.4972437  61   0  13.3 -1.96        9</span></span>
<span><span class="co">#&gt; 2    1    1 0.2855568 0.8489526  76   0 450.0 -3.39        7</span></span>
<span><span class="co">#&gt; 3    1    1 0.1764057 0.7364939  74   0 154.0 -4.95        7</span></span>
<span><span class="co">#&gt; 4    1    1 0.2447630 0.2105843  79   1 500.0 -1.40       24</span></span>
<span><span class="co">#&gt; 5    1    1 0.3274531 0.9073870  83   1 160.0 -2.59        7</span></span>
<span><span class="co">#&gt; 6    1    1 0.6383682 0.3627343  81   1  30.4  0.03       11</span></span>
<span><span class="va">LeukSurv</span><span class="op">&lt;-</span><span class="va">LeukSurv</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">age</span><span class="op">&lt;</span><span class="fl">60</span>,<span class="op">]</span></span>
<span><span class="co">#is.factor(LeukSurv$district)</span></span>
<span><span class="co">#is.factor(LeukSurv$sex)</span></span>
<span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">district</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">district</span><span class="op">)</span></span>
<span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">sex</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">logwbc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">wbc</span><span class="op">+</span><span class="fl">0.001</span><span class="op">)</span></span></code></pre></div>
<p>We fitted two shared frailty models, one with covariates wbc, age, sex and tpi, which is labelled as the wbc model, and the other with log(wbc) replacing wbc, which is labelled as the lwbc model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_LeukSurv_wbc</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">cens</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span>  <span class="op">+</span><span class="va">sex</span><span class="op">+</span> <span class="va">wbc</span> <span class="op">+</span><span class="va">tpi</span>  <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/survival/man/frailty.html" class="external-link">frailty</a></span><span class="op">(</span><span class="va">district</span>, distribution<span class="op">=</span><span class="st">"gamma"</span><span class="op">)</span>, data<span class="op">=</span> <span class="va">LeukSurv</span><span class="op">)</span>,</span>
<span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NA</span>,</span>
<span>  warning <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_LeukSurv_logwbc</span>  <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">cens</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span><span class="va">sex</span> <span class="op">+</span> <span class="va">logwbc</span> <span class="op">+</span> <span class="va">tpi</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/survival/man/frailty.html" class="external-link">frailty</a></span><span class="op">(</span><span class="va">district</span>, distribution<span class="op">=</span><span class="st">"gamma"</span><span class="op">)</span>, data<span class="op">=</span> <span class="va">LeukSurv</span><span class="op">)</span>,</span>
<span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NA</span>,</span>
<span>  warning <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">fit_LeukSurv_wbc</span><span class="op">)</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">fit_LeukSurv_logwbc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"An error or warning has occurred during the model fitting process."</span><span class="op">)</span></span></code></pre></div>
<p>Once the model is fitted, we can calculate Z-residual, censored Z-residual and other residuals for two models.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Zresid.LeukSurv.wbc</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Zresidual.html">Zresidual</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_wbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: pacman</span></span>
<span></span>
<span><span class="va">Zresid.LeukSurv.logwbc</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Zresidual.html">Zresidual</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_logwbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span><span class="op">)</span></span></code></pre></div>
<p>Diagnosis of the overall (GOF) and the Functional Form of Covariates using Z-residuals</p>
<p>A QQ plot based on Z-residuals can be used to graphically assess the model’s overall GOF, and Shapiro-Wilk (SW) or Shapiro-Francia (SF) normality tests applied to Z-residuals can be used to numerically test the overall GOF of the model.</p>
<p>We can see that the QQ plots of Z-residuals of these two models align well with the 45 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^\circ</annotation></semantics></math> diagonal line. The Z-SW tests also give large p-values for two models, where Z-SW is the test method that the normality of Z-residuals is tested with the SW test.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,main.title <span class="op">=</span> <span class="st">"Z-residual QQ plot of wbc model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span>,main.title <span class="op">=</span> <span class="st">"Z-residual QQ plot of lwbc model"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<p>The Z-residuals can be divided into <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> groups by cutting the linear predictors or covariates into equally-spaced intervals. Then we can check whether the Z-residuals of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> groups are homogeneously distributed. A quantitative method to assess the homogeneity of such grouped Z-residuals is to test the equality of group means or variances of the Z-residuals. We employ the F-test in ANOVA to assess the equality of means and Bartlett’s test to examine the equality of variances.</p>
<p>The scatterplots of Z-residuals against the linear predictor don’t exhibit visible trends; their LOWESS lines are very close to the horizontal line at 0; the boxplots of Z-residuals grouped by cutting linear predictors into equal-spaced intervals appear to have equal means and variance across groups. The Z-AOV and Z-BL for linear predictors tests also gives large p-values for the wbc and lwbc models, where Z-AOV and Z-BL are the methods of applying ANOVA and Bartlett to test the equality of the means and variances of Z-residuals against the groups formed with the linear predictor.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1.5</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,</span>
<span>            X<span class="op">=</span><span class="va">fit_LeukSurv_wbc</span><span class="op">$</span><span class="va">linear.predictors</span>,</span>
<span>            xlab<span class="op">=</span><span class="st">"Linear Predictor"</span>,</span>
<span>            main.title <span class="op">=</span> <span class="st">"Z-residual Scatterplot of wbc model"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Outlier Indices: 407</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span>,</span>
<span>            X<span class="op">=</span><span class="va">fit_LeukSurv_logwbc</span><span class="op">$</span><span class="va">linear.predictors</span>,</span>
<span>            xlab<span class="op">=</span><span class="st">"Linear Predictor"</span>,</span>
<span>            main.title <span class="op">=</span> <span class="st">"Z-residual Scatterplot of lwbc model"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Outlier Indices: 364</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,fitted.values<span class="op">=</span><span class="va">fit_LeukSurv_wbc</span><span class="op">$</span><span class="va">linear.predictors</span>,</span>
<span>               main.title <span class="op">=</span> <span class="st">"Z-residual Boxplot of wbc model"</span>,xlab<span class="op">=</span><span class="st">"Linear Predictor"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span>,fitted.values<span class="op">=</span><span class="va">fit_LeukSurv_logwbc</span><span class="op">$</span><span class="va">linear.predictors</span>,</span>
<span>               main.title <span class="op">=</span> <span class="st">"Z-residual Boxplot of lwbc model"</span>,xlab<span class="op">=</span><span class="st">"Linear Predictor"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
<p>The above diagnostics results reveal no serious misspecification in these two models. However, the inspection of the Z-residuals against the covariate wbc/log(wbc) reveals that the functional form of the lwbc model is likely misspecified. The scatterplots and comparative boxplots of the Z-residuals against wbc/log(wbc) are shown below. The LOWESS curve of the wbc model appears to align well with the horizontal line at 0 and the grouped Z-residuals of the wbc model appear to have equal means and variances across groups. However, the diagnosis results for the lwbc model are very different. It appears that there is a non-linear trend in the LOWESS curve of the lwbc model and the grouped Z-residuals appear to have different means across groups. The Z-AOV and Z-BL for covariate wbc and log(wbc) also gives p-values for the wbc and lwbc models as shown in the boxplots. The very small p-value of the Z-AOV for covariate log(wbc) test for the lwbc models strongly suggests that the log transformation of wbc is likely inappropriate for modelling the survival time.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1.5</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,</span>
<span>            X<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">wbc</span>,</span>
<span>            xlab<span class="op">=</span><span class="st">"wbc"</span>,main.title <span class="op">=</span> <span class="st">"Z-residual Scatterplot of wbc model"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Outlier Indices: 407</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span>,</span>
<span>            X<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">logwbc</span>,</span>
<span>            xlab<span class="op">=</span><span class="st">"log(wbc)"</span>,main.title <span class="op">=</span> <span class="st">"Z-residual Scatterplot of lwbc model"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Outlier Indices: 364</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,fitted.values<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">wbc</span>,main.title <span class="op">=</span> <span class="st">"Z-residual Boxplot of wbc model"</span>,xlab<span class="op">=</span><span class="st">"wbc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span>,fitted.values<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">logwbc</span>,main.title <span class="op">=</span> <span class="st">"Z-residual Boxplot of wbc model"</span>, xlab<span class="op">=</span><span class="st">"log(wbc)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<p>The boxplots of the Z-residuals against categorical covariate sex shows the grouped Z-residuals appear to have equal means and variances across groups. The p-values of Z-AOV and Z-BL are greater than 0.05.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,fitted.values<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">sex</span>,xlab<span class="op">=</span><span class="st">"sex"</span>,main.title <span class="op">=</span> <span class="st">"Z-residual Boxplot of wbc model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span>,fitted.values<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">sex</span>,xlab<span class="op">=</span><span class="st">"sex"</span>,main.title <span class="op">=</span> <span class="st">"Z-residual Boxplot of lwbc model"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
<p>The Shapiro-Wilk (SW) or Shapiro-Francia (SF) normality tests applied to Z-residuals can be used to numerically test the overall GOF of the model. Moreover, the Shapiro-Franciard (SF) test can be employed to assess the normality of censored data. The diagnosis of the GOF of survival probabilities can be converted into a diagnosis of the normality of the censored Z-residuals. Thus, by utilizing the gofTestCensored function from the R package EnvStats, one can examine the normality of censored Z-residuals.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sw.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2383382</span></span>
<span><span class="fu">sw.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6750511</span></span>
<span><span class="fu">sf.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2161675</span></span>
<span><span class="fu">sf.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7628117</span></span></code></pre></div>
<p>The Z-residuals can be divided into <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> groups by cutting the covariates or linear predictors into equally-spaced intervals. To quantitatively evaluate the homogeneity of grouped Z-residuals, we propose testing the equality of group means and group variances. For this purpose, we employ the F-test in ANOVA to assess the equality of means and Bartlett’s test to examine the equality of variances.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">anov.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,fitted.values<span class="op">=</span><span class="va">fit_LeukSurv_wbc</span><span class="op">$</span><span class="va">linear.predictors</span>, k.anova<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8623168</span></span>
<span><span class="fu">anov.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span>,fitted.values<span class="op">=</span><span class="va">fit_LeukSurv_logwbc</span><span class="op">$</span><span class="va">linear.predictors</span>, k.anova<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7244503</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,fitted.values<span class="op">=</span><span class="va">fit_LeukSurv_wbc</span><span class="op">$</span><span class="va">linear.predictors</span>, k.bl<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2654078</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span>,fitted.values<span class="op">=</span><span class="va">fit_LeukSurv_logwbc</span><span class="op">$</span><span class="va">linear.predictors</span>, k.bl<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.239635</span></span>
<span></span>
<span><span class="fu">anov.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,fitted.values<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">wbc</span>, k.anova<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.635346</span></span>
<span><span class="fu">anov.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span>,fitted.values<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">logwbc</span>, k.anova<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.908493e-06</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,fitted.values<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">wbc</span>, k.bl<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.951957</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test</a></span><span class="op">(</span><span class="va">Zresid.LeukSurv.logwbc</span>,fitted.values<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">logwbc</span>, k.bl<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2229889</span></span></code></pre></div>
<p>The Z-residual test p-values quoted above contain randomness because of the randomization in generating Z-residuals. To ensure the robustness of the model diagnostics results, we generated 1000 replicated test p-values with 1000 sets of regenerated Z-residuals for each test method. We also provide the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">p_{min}</annotation></semantics></math> values for diagnosing the two models with Z-residual-based tests.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_sims</span><span class="op">&lt;-</span><span class="fl">1000</span></span>
<span><span class="va">cur_time</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sw.LeukSurv.wbc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_sims</span><span class="op">)</span></span>
<span><span class="va">sf.LeukSurv.wbc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_sims</span><span class="op">)</span></span>
<span><span class="va">anov.LeukSurv.lp.wbc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_sims</span><span class="op">)</span></span>
<span><span class="va">anov.LeukSurv.wbc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_sims</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sw.LeukSurv.lwbc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_sims</span><span class="op">)</span></span>
<span><span class="va">sf.LeukSurv.lwbc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_sims</span><span class="op">)</span></span>
<span><span class="va">anov.LeukSurv.lp.lwbc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_sims</span><span class="op">)</span></span>
<span><span class="va">anov.LeukSurv.lwbc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_sims</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sims</span> <span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">Zresid.LeukSurv.wbc</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Zresidual.html">Zresidual</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_wbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">sw.LeukSurv.wbc</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu">sw.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span><span class="op">)</span></span>
<span>  <span class="va">sf.LeukSurv.wbc</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu">sf.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">anov.LeukSurv.lp.wbc</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu">anov.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,</span>
<span>                                            fitted.values<span class="op">=</span><span class="va">fit_LeukSurv_wbc</span><span class="op">$</span><span class="va">linear.predictors</span>,</span>
<span>                                            k.anova<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="va">anov.LeukSurv.wbc</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu">anov.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.wbc</span>,</span>
<span>                                         fitted.values<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">wbc</span>,</span>
<span>                                         k.anova<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Zresid.LeukSurv.lwbc</span><span class="op">&lt;-</span><span class="fu"><a href="reference/Zresidual.html">Zresidual</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_logwbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">sw.LeukSurv.lwbc</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu">sw.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.lwbc</span><span class="op">)</span></span>
<span>  <span class="va">sf.LeukSurv.lwbc</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu">sf.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.lwbc</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">anov.LeukSurv.lp.lwbc</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu">anov.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.lwbc</span>,</span>
<span>                                             fitted.values<span class="op">=</span><span class="va">fit_LeukSurv_logwbc</span><span class="op">$</span><span class="va">linear.predictors</span>,</span>
<span>                                             k.anova<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="va">anov.LeukSurv.lwbc</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu">anov.test.zresid</span><span class="op">(</span><span class="va">Zresid.LeukSurv.lwbc</span>,</span>
<span>                                          fitted.values<span class="op">=</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">logwbc</span>,</span>
<span>                                          k.anova<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">pmin.sw.LeukSurv.wbc</span><span class="op">&lt;-</span><span class="fu">bounds_pvalues</span><span class="op">(</span>pv<span class="op">=</span><span class="va">sw.LeukSurv.wbc</span><span class="op">)</span>;<span class="va">pmin.sw.LeukSurv.wbc</span></span>
<span><span class="co">#&gt; [1] 0.4802859</span></span>
<span><span class="va">pmin.sf.LeukSurv.wbc</span><span class="op">&lt;-</span><span class="fu">bounds_pvalues</span><span class="op">(</span>pv<span class="op">=</span><span class="va">sf.LeukSurv.wbc</span><span class="op">)</span>;<span class="va">pmin.sf.LeukSurv.wbc</span></span>
<span><span class="co">#&gt; [1] 0.6803299</span></span>
<span><span class="va">pmin.aov.lp.LeukSurv.wbc</span><span class="op">&lt;-</span><span class="fu">bounds_pvalues</span><span class="op">(</span>pv<span class="op">=</span><span class="va">anov.LeukSurv.lp.wbc</span><span class="op">)</span>;<span class="va">pmin.aov.lp.LeukSurv.wbc</span></span>
<span><span class="co">#&gt; [1] 0.9918903</span></span>
<span><span class="va">pmin.aov.wbc.LeukSurv</span><span class="op">&lt;-</span><span class="fu">bounds_pvalues</span><span class="op">(</span>pv<span class="op">=</span><span class="va">anov.LeukSurv.wbc</span><span class="op">)</span>;<span class="va">pmin.aov.wbc.LeukSurv</span></span>
<span><span class="co">#&gt; [1] 0.7841056</span></span>
<span></span>
<span><span class="va">pmin.sw.LeukSurv.lwbc</span><span class="op">&lt;-</span><span class="fu">bounds_pvalues</span><span class="op">(</span>pv<span class="op">=</span><span class="va">sw.LeukSurv.lwbc</span><span class="op">)</span>;<span class="va">pmin.sw.LeukSurv.lwbc</span></span>
<span><span class="co">#&gt; [1] 0.5661198</span></span>
<span><span class="va">pmin.sf.LeukSurv.lwbc</span><span class="op">&lt;-</span><span class="fu">bounds_pvalues</span><span class="op">(</span>pv<span class="op">=</span><span class="va">sf.LeukSurv.lwbc</span><span class="op">)</span>;<span class="va">pmin.sf.LeukSurv.lwbc</span></span>
<span><span class="co">#&gt; [1] 0.7611368</span></span>
<span><span class="va">pmin.aov.lp.LeukSurv.lwbc</span><span class="op">&lt;-</span><span class="fu">bounds_pvalues</span><span class="op">(</span>pv<span class="op">=</span><span class="va">anov.LeukSurv.lp.lwbc</span><span class="op">)</span>;<span class="va">pmin.aov.lp.LeukSurv.lwbc</span></span>
<span><span class="co">#&gt; [1] 0.9849655</span></span>
<span><span class="va">pmin.aov.lwbc.LeukSurv</span><span class="op">&lt;-</span><span class="fu">bounds_pvalues</span><span class="op">(</span>pv<span class="op">=</span><span class="va">anov.LeukSurv.lwbc</span><span class="op">)</span>;<span class="va">pmin.aov.lwbc.LeukSurv</span></span>
<span><span class="co">#&gt; [1] 1.222356e-05</span></span></code></pre></div>
<p>The histograms of 1000 replicated Z-residual test p-values for the wbc and lwbc models. The red vertical lines in these histograms show the upper bound summaries of these replicated p-values, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">p_{min}</annotation></semantics></math>. These histograms show that the Z-SW, Z-SF, and Z-AOV with LP tests for both models give a large proportion of p-values greater than 0.05, and the large p-values result in large <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">p_{min}</annotation></semantics></math> values. In contrast, the replicated Z-AOV with log(wbc) p-values for the lwbc model are almost all smaller than 0.001. The consistently small Z-AOV with log(wbc) p-values further confirm that the log transformation of wbc is inappropriate for modelling the survival time.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sw.LeukSurv.wbc</span>,main<span class="op">=</span><span class="st">"Replicated Z-SW P-values for wbc Model"</span>,breaks<span class="op">=</span><span class="fl">20</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Z-SW P-values for wbc Model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">pmin.sw.LeukSurv.wbc</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sw.LeukSurv.lwbc</span>,main<span class="op">=</span><span class="st">"Replicated Z-SW P-values for lwbc Model"</span>,breaks<span class="op">=</span><span class="fl">20</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Z-SW P-values for lwbc Model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">pmin.sw.LeukSurv.lwbc</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sf.LeukSurv.wbc</span>,main<span class="op">=</span><span class="st">"Replicated Z-SF P-values for wbc Model"</span>,breaks<span class="op">=</span><span class="fl">20</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Z-SF P-values for wbc Model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">pmin.sf.LeukSurv.wbc</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sf.LeukSurv.lwbc</span>,main<span class="op">=</span><span class="st">"Replicated Z-SF P-values for lwbc Model"</span>,breaks<span class="op">=</span><span class="fl">20</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Z-SF P-values for lwbc Model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">pmin.sf.LeukSurv.lwbc</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">anov.LeukSurv.lp.wbc</span>,main<span class="op">=</span><span class="st">"Replicated Z-AOV with LP P-values for wbc Model"</span>,breaks<span class="op">=</span><span class="fl">20</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Z-AOV with LP P-values for wbc Model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">pmin.aov.lp.LeukSurv.wbc</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">anov.LeukSurv.lp.lwbc</span>,main<span class="op">=</span><span class="st">"Replicated Z-AOV with LP P-values for lwbc Model"</span>,breaks<span class="op">=</span><span class="fl">20</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Z-AOV with LP P-values for lwbc Model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">pmin.aov.lp.LeukSurv.lwbc</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">anov.LeukSurv.wbc</span>,main<span class="op">=</span><span class="st">"Replicated Z-AOV with wbc P-values for wbc Model"</span>,breaks<span class="op">=</span><span class="fl">20</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Z-AOV with wbc P-values for wbc Model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">pmin.aov.wbc.LeukSurv</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">anov.LeukSurv.lwbc</span>,main<span class="op">=</span><span class="st">"Replicated Z-AOV with wbc P-values for lwbc Model"</span>,breaks<span class="op">=</span><span class="fl">20</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Z-AOV with lwbc P-values for lwbc Model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">pmin.aov.lwbc.LeukSurv</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">censored.Zresid.LeukSurv.wbc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_wbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span>,residual.type<span class="op">=</span><span class="st">"censored Z-residual"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">censored.Zresid.LeukSurv.logwbc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_logwbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span>,residual.type<span class="op">=</span><span class="st">"censored Z-residual"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gof.censore.zresid</span><span class="op">(</span>censored.Zresidual<span class="op">=</span><span class="va">censored.Zresid.LeukSurv.wbc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.5702324</span></span>
<span><span class="fu">gof.censore.zresid</span><span class="op">(</span>censored.Zresidual<span class="op">=</span><span class="va">censored.Zresid.LeukSurv.logwbc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.07535993</span></span></code></pre></div>
<p>The overall GOF tests and graphical checking with CS residuals show that both the wbc and lwbc models provide adequate fits to the dataset. The estimated CHFs of the CS residuals of both of the wbc and lwbc models align closely along the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>45</mn><mo>∘</mo></msup><annotation encoding="application/x-tex">45^{\circ}</annotation></semantics></math> diagonal line.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##unmodified CS residuals</span></span>
<span></span>
<span><span class="va">ucs.LeukSurv.wbc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_wbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span>,residual.type <span class="op">=</span> <span class="st">"Cox-Snell"</span> <span class="op">)</span></span>
<span><span class="va">ucs.LeukSurv.logwbc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_logwbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span>,residual.type <span class="op">=</span> <span class="st">"Cox-Snell"</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">km.ln.LeukSurv.wbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">ucs.LeukSurv.wbc</span>, <span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,type<span class="op">=</span><span class="st">'fleming'</span><span class="op">)</span></span>
<span><span class="va">id.ln.LeukSurv.wbc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">ucs.LeukSurv.wbc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">km.ln.LeukSurv.wbc</span>, fun<span class="op">=</span><span class="st">"cumhaz"</span>, xlab<span class="op">=</span><span class="op">(</span><span class="st">"Cox-Snell Residuals"</span><span class="op">)</span>,</span>
<span>     ylab<span class="op">=</span><span class="op">(</span><span class="st">"Cumulative Hazard Function"</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"CS Residuals of wbc model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">km.ln.LeukSurv.wbc</span><span class="op">$</span><span class="va">time</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">km.ln.LeukSurv.wbc</span><span class="op">$</span><span class="va">surv</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"darkolivegreen4"</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">[</span><span class="va">id.ln.LeukSurv.wbc</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>       pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">[</span><span class="va">id.ln.LeukSurv.wbc</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topleft"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Uncensored"</span>, <span class="st">"Censored"</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkolivegreen4"</span>,<span class="st">"blue"</span><span class="op">)</span>,</span>
<span>       pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">1</span>,xpd <span class="op">=</span> <span class="cn">TRUE</span>,bty<span class="op">=</span><span class="st">"L"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km.ln.LeukSurv.lwbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">ucs.LeukSurv.logwbc</span>, <span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,type<span class="op">=</span><span class="st">'fleming'</span><span class="op">)</span></span>
<span><span class="va">id.ln.LeukSurv.lwbc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">ucs.LeukSurv.logwbc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">km.ln.LeukSurv.lwbc</span>, fun<span class="op">=</span><span class="st">"cumhaz"</span>, xlab<span class="op">=</span><span class="op">(</span><span class="st">"Cox-Snell Residuals"</span><span class="op">)</span>,</span>
<span>     ylab<span class="op">=</span><span class="op">(</span><span class="st">"Cumulative Hazard Function"</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"CS Residuals of lwbc model"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">km.ln.LeukSurv.lwbc</span><span class="op">$</span><span class="va">time</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">km.ln.LeukSurv.lwbc</span><span class="op">$</span><span class="va">surv</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"darkolivegreen4"</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">[</span><span class="va">id.ln.LeukSurv.lwbc</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>       pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">[</span><span class="va">id.ln.LeukSurv.lwbc</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topleft"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Uncensored"</span>, <span class="st">"Censored"</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkolivegreen4"</span>,<span class="st">"blue"</span><span class="op">)</span>,</span>
<span>       pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">1</span>,xpd <span class="op">=</span> <span class="cn">TRUE</span>,bty<span class="op">=</span><span class="st">"L"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="100%"></p>
<p>The martingale residuals are mostly within the interval (-3, 1) for those two models. In the scatterplots of martingale residuals under the wbc model, the LOWESS curves have a slight upward slope on the left, while under the lwbc model, they display a pronounced downward curve. Both of these lines demonstrate noticeable non-horizontal trends.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Martingale residuals</span></span>
<span><span class="va">martg.LeukSurv.wbc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_wbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span>,residual.type <span class="op">=</span> <span class="st">"martingale"</span> <span class="op">)</span></span>
<span><span class="va">martg.LeukSurv.logwbc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_logwbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span>,residual.type <span class="op">=</span> <span class="st">"martingale"</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">wbc</span>,<span class="va">martg.LeukSurv.wbc</span>,ylab<span class="op">=</span><span class="st">"Martingale"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"wbc"</span>,</span>
<span>     main<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Martingale Residual Plot of wbc Model"</span>,cex.main<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"darkolivegreen4"</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>     pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#abline(h=c(3,-3),col="grey")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html" class="external-link">lowess</a></span><span class="op">(</span><span class="va">martg.LeukSurv.wbc</span><span class="op">~</span> <span class="va">LeukSurv</span><span class="op">$</span><span class="va">wbc</span><span class="op">)</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"red"</span>,lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bottomright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Uncensored"</span>, <span class="st">"Censored"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkolivegreen4"</span>,<span class="st">"blue"</span><span class="op">)</span>,</span>
<span>       pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">0.4</span>,xpd <span class="op">=</span> <span class="cn">TRUE</span>,bty<span class="op">=</span><span class="st">"l"</span>,horiz<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">logwbc</span>,<span class="va">martg.LeukSurv.logwbc</span>,ylab<span class="op">=</span><span class="st">"Martingale"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"log(wbc)"</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Martingale Residual Plot of lwbc Model"</span>,cex.main<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"darkolivegreen4"</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>     pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#abline(h=c(3,-3),col="grey")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html" class="external-link">lowess</a></span><span class="op">(</span><span class="va">martg.LeukSurv.logwbc</span><span class="op">~</span> <span class="va">LeukSurv</span><span class="op">$</span><span class="va">logwbc</span><span class="op">)</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"red"</span>,lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bottomright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Uncensored"</span>, <span class="st">"Censored"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkolivegreen4"</span>,<span class="st">"blue"</span><span class="op">)</span>,</span>
<span>       pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">0.4</span>,xpd <span class="op">=</span> <span class="cn">TRUE</span>,bty<span class="op">=</span><span class="st">"l"</span>,horiz<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="100%"></p>
<p>The deviance residuals are more symmetrically distributed than martingale residuals and they are mostly within the interval (-3, 3). In both models, the scatterplots of deviance residuals exhibit strikingly non-horizontal trends in their LOWESS curves.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Deviance residuals</span></span>
<span><span class="va">dev.LeukSurv.wbc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_wbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span>,residual.type <span class="op">=</span> <span class="st">"deviance"</span> <span class="op">)</span></span>
<span><span class="va">dev.LeukSurv.logwbc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span>fit.object <span class="op">=</span> <span class="va">fit_LeukSurv_logwbc</span>,data<span class="op">=</span> <span class="va">LeukSurv</span>,residual.type <span class="op">=</span> <span class="st">"deviance"</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">wbc</span>,<span class="va">dev.LeukSurv.wbc</span>,ylab<span class="op">=</span><span class="st">"Deviance"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"wbc"</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Deviance Residual Plot of wbc Model"</span>,cex.main<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"darkolivegreen4"</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>     pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#abline(h=c(3,-3),col="grey")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html" class="external-link">lowess</a></span><span class="op">(</span><span class="va">dev.LeukSurv.wbc</span><span class="op">~</span> <span class="va">LeukSurv</span><span class="op">$</span><span class="va">wbc</span><span class="op">)</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"red"</span>,lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bottomright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Uncensored"</span>, <span class="st">"Censored"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkolivegreen4"</span>,<span class="st">"blue"</span><span class="op">)</span>,</span>
<span>       pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">0.4</span>,xpd <span class="op">=</span> <span class="cn">TRUE</span>,bty<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">logwbc</span>,<span class="va">dev.LeukSurv.logwbc</span>,ylab<span class="op">=</span><span class="st">"Deviance"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"log(wbc)"</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Deviance Residual Plot of lwbc Model"</span>,cex.main<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"darkolivegreen4"</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>     pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="va">LeukSurv</span><span class="op">$</span><span class="va">cens</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#abline(h=c(3,-3),col="grey")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html" class="external-link">lowess</a></span><span class="op">(</span><span class="va">dev.LeukSurv.logwbc</span><span class="op">~</span> <span class="va">LeukSurv</span><span class="op">$</span><span class="va">logwbc</span><span class="op">)</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"red"</span>,lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"bottomright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Uncensored"</span>, <span class="st">"Censored"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkolivegreen4"</span>,<span class="st">"blue"</span><span class="op">)</span>,</span>
<span>       pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">.4</span>,xpd <span class="op">=</span> <span class="cn">TRUE</span>,bty<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tiw150/Zresidual/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/tiw150/Zresidual/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled"><li>
</li></ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing Zresidual</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tingxuan Wu <br><small class="roles"> Author, maintainer </small>  </li>
<li>Longhai Li <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-3074-8584" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Tingxuan Wu, Longhai Li.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
