[{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"vignette explains use Zresidual package calculate Z-residuals based output coxph function survival package R. also serves demonstration use Z-residuals assess overall goodness fit (GOF) identify specific model misspecifications semi-parametric shared frailty models. fully understand detailed definitions example data analysis results, please refer original paper titled “Z-residual diagnostics detecting misspecification functional form covariates shared frailty models.","code":""},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"definition-of-z-residual","dir":"Articles","previous_headings":"","what":"Definition of Z-residual","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"use Z-residual diagnose shared frailty models Cox proportional hazard setting baseline function unspecified. Suppose gg groups individuals, group containing nin_i individuals, indexed ii = 1, 2, , gg case clustered failure survival data. Let yijy_{ij} possibly right-censored observation jjth individual iith group, δij\\delta_{ij} indicator uncensored. normalized randomized survival probabilities (RSPs) yijy_{ij} shared frailty model defined : SijR(yij,δij,Uij)={Sij(yij),yij uncensored, .e., δij=1,UijSij(yij),yij censored, .e., δij=0,\\begin{equation} S_{ij}^{R}(y_{ij}, \\delta_{ij}, U_{ij}) = \\left\\{ \\begin{array}{rl} S_{ij}(y_{ij}), & \\text{$y_{ij}$ uncensored, .e., $\\delta_{ij}=1$,}\\\\ U_{ij}\\,S_{ij}(y_{ij}), & \\text{$y_{ij}$ censored, .e., $\\delta_{ij}=0$,}  \\end{array} \\right. \\label{rsp}  \\end{equation} UijU_{ij} uniform random number (0,1)(0, 1), Sij(⋅)S_{ij}(\\cdot) postulated survival function tijt_{ij} given xijx_{ij}. SijR(yij,δij,Uij)S_{ij}^{R}(y_{ij}, \\delta_{ij}, U_{ij}) random number 00 Sij(yij)S_{ij}(y_{ij}) yijy_{ij} censored. proved RSPs uniformly distributed (0,1)(0,1) given xix_{} true model . Therefore, RSPs can transformed residuals desired distribution. prefer transform normal quantile: rijZ(yij,δij,Uij)=−Φ−1(SijR(yij,δij,Uij)),\\begin{equation} r_{ij}^{Z}(y_{ij}, \\delta_{ij}, U_{ij})=-\\Phi^{-1} (S_{ij}^R(y_{ij}, \\delta_{ij}, U_{ij})),\\label{zresid} \\end{equation} normally distributed true model, can conduct model diagnostics Z-residuals censored data way conducting model diagnostics normal regression model. advantages transforming RSPs Z-residuals. First, diagnostics methods checking normal regression rich literature. Second, transforming RSPs normal deviates facilitates identification extremely small large RSPs. frequency small RSPs may small highlighted plots RSPs. However, presence extreme SPs, even , indicative model misspecification. Normal transformation can highlight extreme RSPs.","code":""},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"can install development version package GitHub : devtools::install_github(“tiw150/Zresidual”)","code":""},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"Li, L., Wu, T., Feng, C., 2021. Model Diagnostics Censored Regression via Randomized Survival Probabilities. Statistics Medicine, 2020+. https://doi.org/10.1002/sim.8852; https://onlinelibrary.wiley.com/share/author/F8DKBTX7IT7UT2WTSZP3?target=10.1002/sim.8852 Wu, T., Li, L., & Feng, C. (2024). Z-residual diagnostic tool assessing covariate functional form shared frailty models. Journal Applied Statistics, 52(1), 28–58. https://doi.org/10.1080/02664763.2024.2355551","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"a-real-dataset","dir":"Articles","previous_headings":"Examples for Illustration and Demonstration","what":"A real dataset","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"example provides fundamental illustration using Z-residuals diagnosing overall goodness fit (GOF) functional form covariates real application modelling survival times acute myeloid leukemia patients. dataset employed analysis contains 411 patients recorded M. D. Anderson Cancer Center 1980 1996. patients age 60 hailed 24 administrative districts. data collected information survival time acute myeloid leukemia prognostic factors, including age, sex, white blood cell count (wbc) diagnosis, townsend score (tpi) higher values indicate less affluent areas. censoring rate 29.2%. response variable interest survival time days, time entry study death. preliminary study showed wbc highly right-skewed. Logarithm transformation often used reduce impact extremely large values covariate response variable, wbc variable application. However, logarithm transformation may mask impact extremely large values covariate outcome variable.","code":"library(Zresidual) library(survival) library(EnvStats) library(foreach) data(\"LeukSurv\") LeukSurv$district<-as.factor(LeukSurv$district) LeukSurv$sex<-as.factor(LeukSurv$sex) LeukSurv$logwbc<- log(LeukSurv$wbc+0.001) LeukSurv<-LeukSurv[LeukSurv$age<60,]"},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"fit-the-models","dir":"Articles","previous_headings":"Examples for Illustration and Demonstration","what":"Fit the models","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"fitted two shared frailty models, one covariates wbc, age, sex tpi, labelled wbc model, log(wbc) replacing wbc, labelled lwbc model.","code":"fit_LeukSurv_wbc <- coxph(Surv(time, cens) ~ age  +sex+ wbc +tpi  +           frailty(district, distribution=\"gamma\"), data= LeukSurv) fit_LeukSurv_logwbc  <- coxph(Surv(time, cens) ~ age +sex + logwbc + tpi +           frailty(district, distribution=\"gamma\"), data= LeukSurv)"},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"z-residual-calculation","dir":"Articles","previous_headings":"Examples for Illustration and Demonstration","what":"Z-residual calculation","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"model fitted, can calculate Z-residuals two models.","code":"Zresid.LeukSurv.wbc<-Zresidual(fit.object = fit_LeukSurv_wbc,nrep=100) Zresid.LeukSurv.logwbc<-Zresidual(fit.object = fit_LeukSurv_logwbc,nrep=100)"},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"graphically-assess-model","dir":"Articles","previous_headings":"Examples for Illustration and Demonstration","what":"Graphically assess model","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"Diagnosing overall goodness--fit (GOF) using Z-residuals follows: QQ plot based Z-residuals can used graphically assess model’s overall GOF, Shapiro-Wilk (SW) Shapiro-Francia (SF) normality tests applied Z-residuals can used numerically test overall GOF model. can see QQ plots Z-residuals two models align well 45 ∘^\\circ diagonal line. Z-SW tests also give large p-values two models, Z-SW test method normality Z-residuals tested SW test. Figure 1: QQ plots Z-residuals wbc (left panels) lwbc (right panels) models fitted survival data acute myeloid leukemia patients Z-residuals can divided kk groups cutting linear predictors covariates equally-spaced intervals. can check whether Z-residuals kk groups homogeneously distributed. quantitative method assess homogeneity grouped Z-residuals test equality group means variances Z-residuals. employ F-test ANOVA assess equality means Bartlett’s test examine equality variances. scatterplots Z-residuals linear predictor don’t exhibit visible trends; LOWESS lines close horizontal line 0; boxplots Z-residuals grouped cutting linear predictors equal-spaced intervals appear equal means variance across groups. Z-AOV Z-BL linear predictors tests also gives large p-values wbc lwbc models, Z-AOV Z-BL methods applying ANOVA Bartlett test equality means variances Z-residuals groups formed linear predictor. Identifing specific model misspecifications using Z-residuals follows: diagnostics results reveal serious misspecification two models. However, inspection Z-residuals covariate wbc/log(wbc) reveals functional form lwbc model likely misspecified. scatterplots comparative boxplots Z-residuals wbc/log(wbc) shown . LOWESS curve wbc model appears align well horizontal line 0 grouped Z-residuals wbc model appear equal means variances across groups. However, diagnosis results lwbc model different. appears non-linear trend LOWESS curve lwbc model grouped Z-residuals appear different means across groups. Z-AOV Z-BL covariate wbc log(wbc) also gives p-values wbc lwbc models shown boxplots. small p-value Z-AOV covariate log(wbc) test lwbc models strongly suggests log transformation wbc likely inappropriate modelling survival time.","code":"foreach (j = 1:nrep) %do%   {     par(mfrow = c(1, 2), mar = c(4, 4, 2, 2))     qqnorm.zresid(Zresid.LeukSurv.wbc, main.title = \"Z-residual QQ plot of wbc model\",index=j)     qqnorm.zresid(Zresid.LeukSurv.logwbc, main.title = \"Z-residual QQ plot of lwbc model\",index=j)   } ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter ## Warning in plot.window(...): \"index\" is not a graphical parameter ## Warning in plot.xy(xy, type, ...): \"index\" is not a graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in axis(side = side, at = at, labels = labels, ...): \"index\" is not a ## graphical parameter ## Warning in box(...): \"index\" is not a graphical parameter ## Warning in title(...): \"index\" is not a graphical parameter"},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"quantitative-assess-model","dir":"Articles","previous_headings":"Examples for Illustration and Demonstration","what":"Quantitative assess model","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"Shapiro-Wilk (SW) Shapiro-Francia (SF) normality tests applied Z-residuals can used numerically test overall GOF model. Moreover, Shapiro-Franciard (SF) test can employed assess normality censored data. diagnosis GOF survival probabilities can converted diagnosis normality censored Z-residuals. Thus, utilizing gofTestCensored function R package EnvStats, one can examine normality censored Z-residuals. Z-residuals can divided kk groups cutting covariates linear predictors equally-spaced intervals. quantitatively evaluate homogeneity grouped Z-residuals, propose testing equality group means group variances. purpose, employ F-test ANOVA assess equality means Bartlett’s test examine equality variances. histograms 1000 replicated Z-residual test p-values wbc lwbc models. red vertical lines histograms show upper bound summaries replicated p-values, pminp_{min}. histograms show Z-SW, Z-SF, Z-AOV LP tests models give large proportion p-values greater 0.05, large p-values result large pminp_{min} values. contrast, replicated Z-AOV log(wbc) p-values lwbc model almost smaller 0.001. consistently small Z-AOV log(wbc) p-values confirm log transformation wbc inappropriate modelling survival time. Figure 5: histograms 1000 replicated Z-SW, Z-SF, Z-AOV-LP Z-AOV-log(wbc) p-values wbc model (left panels) lwbc model (right panels) fitted survival times acute myeloid leukemia patients. vertical red lines indicate pminp_{min} 1000 replicated p-values. Note upper limit x-axis Z-AOV-log(wbc) p-values lwbc model 0.005, 1 others.","code":"sw.wbc<-sw.test.zresid(Zresid.LeukSurv.wbc) sw.lwbc<-sw.test.zresid(Zresid.LeukSurv.logwbc) sf.wbc<-sf.test.zresid(Zresid.LeukSurv.wbc) sf.lwbc<-sf.test.zresid(Zresid.LeukSurv.logwbc) gof_tests<-data.frame(sw.wbc,sw.lwbc,sf.wbc,sf.lwbc) aov.wbc.lp<-aov.test.zresid(Zresid.LeukSurv.wbc, k.anova=10) aov.lwbc.lp<-aov.test.zresid(Zresid.LeukSurv.logwbc, k.anova=10)  #bl.wbc.lp<-bartlett.test.zresid(Zresid.LeukSurv.wbc, k.bl=10) #bl.lwbc.lp<-bartlett.test.zresid(Zresid.LeukSurv.logwbc, k.bl=10)  aov.wbc<-aov.test.zresid(Zresid.LeukSurv.wbc,X=\"wbc\", k.anova=10) aov.lwbc<-aov.test.zresid(Zresid.LeukSurv.logwbc,X=\"logwbc\", k.anova=10)  #bl.wbc<-bartlett.test.zresid(Zresid.LeukSurv.wbc,X=\"wbc\", k.bl=10) #bl.lwbc<-bartlett.test.zresid(Zresid.LeukSurv.logwbc,X=\"logwbc\", k.bl=10)  homogeneity_tests<-data.frame(aov.wbc.lp,aov.lwbc.lp,aov.wbc,aov.lwbc) par(mfrow = c(4,2),mar=c(4,4,2,2)) hist(sw.wbc,main=\"Replicated Z-SW P-values for wbc Model\",breaks=20,      xlab=\"Z-SW P-values for wbc Model\") abline(v=pmin.sw.LeukSurv.wbc,col=\"red\") hist(sw.lwbc,main=\"Replicated Z-SW P-values for lwbc Model\",breaks=20,      xlab=\"Z-SW P-values for lwbc Model\") abline(v=pmin.sw.LeukSurv.lwbc,col=\"red\")  hist(sf.wbc,main=\"Replicated Z-SF P-values for wbc Model\",breaks=20,      xlab=\"Z-SF P-values for wbc Model\") abline(v=pmin.sf.LeukSurv.wbc,col=\"red\") hist(sf.lwbc,main=\"Replicated Z-SF P-values for lwbc Model\",breaks=20,      xlab=\"Z-SF P-values for lwbc Model\") abline(v=pmin.sf.LeukSurv.lwbc,col=\"red\")  hist(aov.wbc.lp,main=\"Replicated Z-AOV with LP P-values for wbc Model\",breaks=20,      xlab=\"Z-AOV with LP P-values for wbc Model\") abline(v=pmin.aov.lp.LeukSurv.wbc,col=\"red\") hist(aov.lwbc.lp,main=\"Replicated Z-AOV with LP P-values for lwbc Model\",breaks=20,      xlab=\"Z-AOV with LP P-values for lwbc Model\") abline(v=pmin.aov.lp.LeukSurv.lwbc,col=\"red\")  hist(aov.wbc,main=\"Replicated Z-AOV with wbc P-values for wbc Model\",breaks=20,      xlab=\"Z-AOV with wbc P-values for wbc Model\") abline(v=pmin.aov.wbc.LeukSurv,col=\"red\") hist(aov.lwbc,main=\"Replicated Z-AOV with wbc P-values for lwbc Model\",breaks=20,      xlab=\"Z-AOV with lwbc P-values for lwbc Model\") abline(v=pmin.aov.lwbc.LeukSurv,col=\"red\")"},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"censored-z-residuals","dir":"Articles","previous_headings":"Other residual calculation","what":"censored Z-residuals","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"normality censored Z-residuals tested extended SF method censored observations, implemented gofTestCensored R package EnvStats.","code":"censored.Zresid.LeukSurv.wbc<-residuals(fit.object = fit_LeukSurv_wbc,data= LeukSurv,residual.type=\"censored Z-residual\")  censored.Zresid.LeukSurv.logwbc<-residuals(fit.object = fit_LeukSurv_logwbc,data= LeukSurv,residual.type=\"censored Z-residual\")  gof.censored.zresidual(censored.Zresidual=censored.Zresid.LeukSurv.wbc) ## [1] 0.5702324 gof.censored.zresidual(censored.Zresidual=censored.Zresid.LeukSurv.logwbc) ## [1] 0.07535993"},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"cox-snell-residual","dir":"Articles","previous_headings":"Other residual calculation","what":"Cox-Snell residual","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"overall GOF tests graphical checking Cox-Snell residuals show wbc lwbc models provide adequate fits dataset. estimated CHFs CS residuals wbc lwbc models align closely along 45∘45^{\\circ} diagonal line. Figure 6: estimated CHFs CS residuals wbc (left panels) lwbc (right panels) models fitted survival data acute myeloid leukemia patients","code":"##unmodified CS residuals ucs.LeukSurv.wbc<-residuals(fit.object = fit_LeukSurv_wbc,data= LeukSurv,residual.type = \"Cox-Snell\" ) ucs.LeukSurv.logwbc<-residuals(fit.object = fit_LeukSurv_logwbc,data= LeukSurv,residual.type = \"Cox-Snell\" )  par(mfrow = c(1,2)) plot.cs.residual(cs.residual=ucs.LeukSurv.wbc,main.title = \"CS Residuals of wbc model\") plot.cs.residual(cs.residual=ucs.LeukSurv.logwbc,main.title = \"CS Residuals of lwbc model\")"},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"martingale-residual","dir":"Articles","previous_headings":"Other residual calculation","what":"Martingale residual","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"martingale residuals mostly within interval (-3, 1) two models. scatterplots martingale residuals wbc model, LOWESS curves slight upward slope left, lwbc model, display pronounced downward curve. lines demonstrate noticeable non-horizontal trends. Figure 7: Scatter plot martingale residuals wbc (left panels) lwbc (right panels) models fitted survival data acute myeloid leukemia patients","code":"martg.LeukSurv.wbc<-residuals(fit.object = fit_LeukSurv_wbc,data= LeukSurv,residual.type = \"martingale\") martg.LeukSurv.logwbc<-residuals(fit.object = fit_LeukSurv_logwbc,data= LeukSurv,residual.type = \"martingale\" )  par(mfrow = c(1,2)) plot.martg.resid(martg.LeukSurv.wbc,X=\"wbc\",main.title = \"Martingale Residuals of wbc Model\") plot.martg.resid(martg.LeukSurv.logwbc,X=\"logwbc\",main.title = \"Martingale Residuals of lwbc Model\")"},{"path":"https://tiw150.github.io/Zresidual/articles/Zresidual_demo.html","id":"deviance-residual","dir":"Articles","previous_headings":"Other residual calculation","what":"Deviance residual","title":"Z-residual diagnostic tool for assessing covariate functional form in shared frailty models","text":"deviance residuals symmetrically distributed martingale residuals mostly within interval (-3, 3). models, scatterplots deviance residuals exhibit strikingly non-horizontal trends LOWESS curves. Figure 8: Scatter plot deviance residuals wbc (left panels) lwbc (right panels) models fitted survival data acute myeloid leukemia patients","code":"#Deviance residuals dev.LeukSurv.wbc<-residuals(fit.object = fit_LeukSurv_wbc,data= LeukSurv,residual.type = \"deviance\" ) dev.LeukSurv.logwbc<-residuals(fit.object = fit_LeukSurv_logwbc,data= LeukSurv,residual.type = \"deviance\" )  par(mfrow = c(1,2)) plot.dev.resid(dev.LeukSurv.wbc,X=\"wbc\",main.title = \"Deviance Residuals of wbc Model\") plot.dev.resid(dev.LeukSurv.logwbc,X=\"logwbc\",main.title = \"Deviance Residuals of lwbc Model\")"},{"path":"https://tiw150.github.io/Zresidual/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Tingxuan Wu. Author, maintainer. Hettiarachchige Alias Egodage Dananji. Author. Longhai Li. Author. Cindy Feng. Contributor.","code":""},{"path":"https://tiw150.github.io/Zresidual/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wu T, Dananji H, Li L (2025). Zresidual: Z-residual Regression Modelling. R package version 0.1.0, https://tiw150.github.io/Zresidual.","code":"@Manual{,   title = {Zresidual: Z-residual for Regression Modelling},   author = {Tingxuan Wu and Hettiarachchige Alias Egodage Dananji and Longhai Li},   year = {2025},   note = {R package version 0.1.0},   url = {https://tiw150.github.io/Zresidual}, }"},{"path":"https://tiw150.github.io/Zresidual/index.html","id":"z-residuals","dir":"","previous_headings":"","what":"Z-residual for Regression Modelling","title":"Z-residual for Regression Modelling","text":"Z-residual residual diagnosis tool diagnosing survival models generalized linear models.","code":""},{"path":"https://tiw150.github.io/Zresidual/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Z-residual for Regression Modelling","text":"can install development version package GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"tiw150/Zresidual\")"},{"path":"https://tiw150.github.io/Zresidual/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Z-residual for Regression Modelling","text":"Li, L., Wu, T., Feng, C., 2021. Model Diagnostics Censored Regression via Randomized Survival Probabilities. Statistics Medicine, 2020+. https://doi.org/10.1002/sim.8852; https://onlinelibrary.wiley.com/share/author/F8DKBTX7IT7UT2WTSZP3?target=10.1002/sim.8852 Wu, T., Li, L., & Feng, C. (2023). Z-residual diagnostics detecting misspecification functional form covariates shared frailty models. arXiv, page 2302.09106, 2023. review Journal Applied Statistics. https://arxiv.org/abs/2302.09106","code":""},{"path":"https://tiw150.github.io/Zresidual/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Z-residual for Regression Modelling","text":"example provides fundamental illustration using Z-residuals diagnosing overall goodness fit (GOF) functional form covariates real application modelling survival times acute myeloid leukemia patients.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/CV.Zresidual.coxph.frailty.html","id":null,"dir":"Reference","previous_headings":"","what":"CV Zresidual for shared fraitly model using coxph function — CV.Zresidual.coxph.frailty","title":"CV Zresidual for shared fraitly model using coxph function — CV.Zresidual.coxph.frailty","text":"CV Zresidual shared fraitly model using coxph function","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/CV.Zresidual.coxph.frailty.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CV Zresidual for shared fraitly model using coxph function — CV.Zresidual.coxph.frailty","text":"","code":"CV.Zresidual.coxph.frailty(fit.coxph, data, nfolds, foldlist, n.rep)"},{"path":"https://tiw150.github.io/Zresidual/reference/CV.Zresidual.coxph.html","id":null,"dir":"Reference","previous_headings":"","what":"CV Zresidual for shared fraitly model using coxph function — CV.Zresidual.coxph","title":"CV Zresidual for shared fraitly model using coxph function — CV.Zresidual.coxph","text":"CV Zresidual shared fraitly model using coxph function","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/CV.Zresidual.coxph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CV Zresidual for shared fraitly model using coxph function — CV.Zresidual.coxph","text":"","code":"CV.Zresidual.coxph(fit.coxph, data, nfolds, foldlist, n.rep)"},{"path":"https://tiw150.github.io/Zresidual/reference/CV.Zresidual.html","id":null,"dir":"Reference","previous_headings":"","what":"A title — CV.Zresidual","title":"A title — CV.Zresidual","text":"descriptions","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/CV.Zresidual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A title — CV.Zresidual","text":"","code":"CV.Zresidual(fit.object, nfolds, foldlist = NULL, data = NULL, nrep = 1)"},{"path":"https://tiw150.github.io/Zresidual/reference/CV.Zresidual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A title — CV.Zresidual","text":"fit.object fit object one 'coxph' 'survreg'. data Data used fitting survival model.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/CV.Zresidual.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A title — CV.Zresidual","text":"ZresidCV Z-residual SPSurvival Probabilities linear.predlinear predictor","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/CV.Zresidual.survreg.html","id":null,"dir":"Reference","previous_headings":"","what":"CV Zresidual for shared fraitly model using coxph function — CV.Zresidual.survreg","title":"CV Zresidual for shared fraitly model using coxph function — CV.Zresidual.survreg","text":"CV Zresidual shared fraitly model using coxph function","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/CV.Zresidual.survreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CV Zresidual for shared fraitly model using coxph function — CV.Zresidual.survreg","text":"","code":"CV.Zresidual.survreg(fit.survreg, data, nfolds, foldlist, n.rep)"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.bernoulli.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Z-Residuals for a Bernoulli/Logistic Model — Zresidual.bernoulli","title":"Compute Z-Residuals for a Bernoulli/Logistic Model — Zresidual.bernoulli","text":"Computes Z-residuals fitted Bayesian Bernoulli/Logistic (binary) model. Z-residuals calculated using posterior predictive methods can used model diagnostics.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.bernoulli.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Z-Residuals for a Bernoulli/Logistic Model — Zresidual.bernoulli","text":"","code":"Zresidual.bernoulli(fit, method = \"iscv\", n.rep = 1)"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.bernoulli.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Z-Residuals for a Bernoulli/Logistic Model — Zresidual.bernoulli","text":"fit fitted brms model object. method Character string specifying residual calculation method: \"iscv\" importance-sampled cross-validated randomized predictive p-values, \"rpost\" randomized posterior predictive p-values \"mpost\" middle-value posterior predictive p-values. Default \"iscv\". n.rep Integer; number replicated Z-residual sets generate. Default 1.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.bernoulli.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Z-Residuals for a Bernoulli/Logistic Model — Zresidual.bernoulli","text":"numeric matrix Z-residuals attributes: type: Type outcome (Bernoulli) zero_id: Indices zero outcomes log_pmf: Log-probability mass function values log_cdf: Log-cumulative distribution function values covariates: Model covariates linear.pred: Linear predictor values fitted model returned object class c(\"zresid\", \"matrix\").","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.bernoulli.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Z-Residuals for a Bernoulli/Logistic Model — Zresidual.bernoulli","text":"function performs following steps: Extracts observed response vector model data. Computes log-PMF log-CDF Bernoulli model using         log.pred.dist.bern. Generates posterior predictive p-values according         specified method. Converts p-values Z-residuals via negative quantile         standard normal distribution. output matrix Z-residuals one column per replication.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.bernoulli.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Z-Residuals for a Bernoulli/Logistic Model — Zresidual.bernoulli","text":"","code":"if (FALSE) { # \\dontrun{ # Compute Z-residuals using ISCV method zres <- Zresidual.bernoulli(fit, method = \"iscv\", n.rep = 2)  # Compute Z-residuals using posterior predictive method zres_post <- Zresidual.bernoulli(fit, method = \"post\") } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.coxph.frailty.html","id":null,"dir":"Reference","previous_headings":"","what":"A title — Zresidual.coxph.frailty","title":"A title — Zresidual.coxph.frailty","text":"descriptions","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.coxph.frailty.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A title — Zresidual.coxph.frailty","text":"","code":"Zresidual.coxph.frailty(fit_coxph, traindata, newdata, n.rep = 1)"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.coxph.frailty.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A title — Zresidual.coxph.frailty","text":"fit_coxph fit object coxph function frailty item survival package.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.coxph.frailty.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A title — Zresidual.coxph.frailty","text":"ZresidZ-residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.coxph.html","id":null,"dir":"Reference","previous_headings":"","what":"A title — Zresidual.coxph","title":"A title — Zresidual.coxph","text":"descriptions","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.coxph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A title — Zresidual.coxph","text":"","code":"Zresidual.coxph(fit_coxph, newdata, n.rep = 1)"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.coxph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A title — Zresidual.coxph","text":"fit_coxph fit object coxph function survival package.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.coxph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A title — Zresidual.coxph","text":"ZresidZ-residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.html","id":null,"dir":"Reference","previous_headings":"","what":"A title — Zresidual","title":"A title — Zresidual","text":"descriptions","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A title — Zresidual","text":"","code":"Zresidual(fit.object, nrep = 1, data = NULL, type = NULL, method = \"iscv\")"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A title — Zresidual","text":"fit.object fit object one 'coxph', 'survreg' 'brms'.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A title — Zresidual","text":"Zresid Z-residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.negbinomial.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Z-Residuals for Hurdle or Count Negative Binomial Models — Zresidual.hurdle.negbinomial","title":"Compute Z-Residuals for Hurdle or Count Negative Binomial Models — Zresidual.hurdle.negbinomial","text":"Computes Z-residuals fitted Bayesian hurdle count models negative binomial distribution. Z-residuals can calculated zeros, counts, overall hurdle distribution, can used model diagnostics.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.negbinomial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Z-Residuals for Hurdle or Count Negative Binomial Models — Zresidual.hurdle.negbinomial","text":"","code":"Zresidual.hurdle.negbinomial(fit, type, method = \"iscv\", n.rep = 1)"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.negbinomial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Z-Residuals for Hurdle or Count Negative Binomial Models — Zresidual.hurdle.negbinomial","text":"fit fitted brms model object hurdle count negative binomial outcome. type Character string specifying part model calculate Z-residuals : \"zero\" hurdle/zero portion, \"count\" truncated negative binomial counts, \"hurdle\" full hurdle-negative binomial model. method Character string specifying residual calculation method: \"iscv\" importance-sampled cross-validated randomized predictive p-values, \"rpost\" randomized posterior predictive p-values \"mpost\" middle-value posterior predictive p-values. Default \"iscv\". n.rep Integer; number replicated Z-residual sets generate. Default 1.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.negbinomial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Z-Residuals for Hurdle or Count Negative Binomial Models — Zresidual.hurdle.negbinomial","text":"numeric matrix Z-residuals attributes: type: specified model component zero_id: Indices zero outcomes log_pmf: Log-probability mass function values log_cdf: Log-cumulative distribution function values covariates: Model covariates linear.pred: Linear predictor values fitted model returned object class c(\"zresid\", \"matrix\").","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.negbinomial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Z-Residuals for Hurdle or Count Negative Binomial Models — Zresidual.hurdle.negbinomial","text":"function performs following steps: Extracts observed response vector model data. Computes log-PMF log-CDF specified part model         using corresponding log.pred.dist.* function. Generates posterior predictive p-values according         specified method. Converts p-values Z-residuals via negative quantile         standard normal distribution. output matrix Z-residuals one column per replication.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.negbinomial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Z-Residuals for Hurdle or Count Negative Binomial Models — Zresidual.hurdle.negbinomial","text":"","code":"if (FALSE) { # \\dontrun{ # Compute Z-residuals for counts zres_counts <- Zresidual.hurdle.negbinomial(fit, type = \"count\", method = \"iscv\")  # Compute Z-residuals for the full hurdle model with 2 replicates zres_hurdle <- Zresidual.hurdle.negbinomial(fit, type = \"hurdle\", n.rep = 2) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.poisson.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Z-Residuals for Hurdle or Count Poisson Models — Zresidual.hurdle.poisson","title":"Compute Z-Residuals for Hurdle or Count Poisson Models — Zresidual.hurdle.poisson","text":"Computes Z-residuals fitted Bayesian hurdle count models Poisson distribution. Z-residuals can calculated zeros, counts, overall hurdle distribution, can used model diagnostics.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.poisson.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Z-Residuals for Hurdle or Count Poisson Models — Zresidual.hurdle.poisson","text":"","code":"Zresidual.hurdle.poisson(fit, type, method = \"iscv\", n.rep = 1)"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.poisson.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Z-Residuals for Hurdle or Count Poisson Models — Zresidual.hurdle.poisson","text":"fit fitted brms model object hurdle count Poisson outcome. type Character string specifying part model calculate Z-residuals : \"zero\" hurdle/zero portion, \"count\" truncated Poisson counts, \"hurdle\" full hurdle-Poisson model. method Character string specifying residual calculation method: \"iscv\" importance-sampled cross-validated randomized predictive p-values, \"rpost\" randomized posterior predictive p-values \"mpost\" middle-value posterior predictive p-values. Default \"iscv\". n.rep Integer; number replicated Z-residual sets generate. Default 1.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.poisson.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Z-Residuals for Hurdle or Count Poisson Models — Zresidual.hurdle.poisson","text":"numeric matrix Z-residuals attributes: type: specified model component zero_id: Indices zero outcomes log_pmf: Log-probability mass function values log_cdf: Log-cumulative distribution function values covariates: Model covariates linear.pred: Linear predictor values fitted model returned object class c(\"zresid\", \"matrix\").","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.poisson.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Z-Residuals for Hurdle or Count Poisson Models — Zresidual.hurdle.poisson","text":"function performs following steps: Extracts observed response vector model data. Computes log-PMF log-CDF specified part model         using corresponding log.pred.dist.* function. Generates posterior predictive p-values according         specified method. Converts p-values Z-residuals via negative quantile         standard normal distribution. output matrix Z-residuals one column per replication.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.poisson.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Z-Residuals for Hurdle or Count Poisson Models — Zresidual.hurdle.poisson","text":"","code":"if (FALSE) { # \\dontrun{ # Compute Z-residuals for counts zres_counts <- Zresidual.hurdle.poisson(fit, type = \"count\", method = \"iscv\")  # Compute Z-residuals for the full hurdle model with 2 replicates zres_hurdle <- Zresidual.hurdle.poisson(fit, type = \"hurdle\", n.rep = 2) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.negbinomial.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Z-Residuals for Negative Binomial Models — Zresidual.negbinomial","title":"Compute Z-Residuals for Negative Binomial Models — Zresidual.negbinomial","text":"Computes Z-residuals fitted Bayesian negative binomial models. Z-residuals useful model diagnostics, including checking fit overdispersion, can calculated using posterior cross-validated predictive p-values.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.negbinomial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Z-Residuals for Negative Binomial Models — Zresidual.negbinomial","text":"","code":"Zresidual.negbinomial(fit, method = \"iscv\", n.rep = 1)"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.negbinomial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Z-Residuals for Negative Binomial Models — Zresidual.negbinomial","text":"fit fitted brms model object negative binomial outcome. method Character string specifying residual calculation method: \"iscv\" importance-sampled cross-validated randomized predictive p-values, \"rpost\" posterior predictive p-values, \"mpost\" marginal posterior predictive p-values. Default \"iscv\". n.rep Integer; number replicated Z-residual sets generate. Default 1.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.negbinomial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Z-Residuals for Negative Binomial Models — Zresidual.negbinomial","text":"numeric matrix Z-residuals attributes: type: specified model component (currently NULL) zero_id: Indices zero outcomes log_pmf: Log-probability mass function values log_cdf: Log-cumulative distribution function values covariates: Model covariates linear.pred: Linear predictor values fitted model returned object class c(\"zresid\", \"matrix\").","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.negbinomial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Z-Residuals for Negative Binomial Models — Zresidual.negbinomial","text":"function performs following steps: Extracts observed response vector model data. Computes log-PMF log-CDF negative binomial model         using log.pred.dist.NB. Generates randomized posterior predictive p-values according         specified method. Converts p-values Z-residuals via negative quantile         standard normal distribution. output matrix Z-residuals one column per replication.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.negbinomial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Z-Residuals for Negative Binomial Models — Zresidual.negbinomial","text":"","code":"if (FALSE) { # \\dontrun{ # Compute Z-residuals for a negative binomial model zres_nb <- Zresidual.negbinomial(fit, method = \"iscv\")  # Compute Z-residuals with 2 replicates using posterior predictive p-values zres_nb_post <- Zresidual.negbinomial(fit, method = \"rpost\", n.rep = 2) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.poisson.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Z-Residuals for Poisson Models — Zresidual.poisson","title":"Compute Z-Residuals for Poisson Models — Zresidual.poisson","text":"Computes Z-residuals fitted Bayesian poisson models. Z-residuals useful model diagnostics, including checking fit overdispersion, can calculated using posterior cross-validated predictive p-values.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.poisson.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Z-Residuals for Poisson Models — Zresidual.poisson","text":"","code":"Zresidual.poisson(fit, method = \"iscv\", n.rep = 1)"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.poisson.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Z-Residuals for Poisson Models — Zresidual.poisson","text":"fit fitted brms model object poisson outcome. method Character string specifying residual calculation method: \"iscv\" importance-sampled cross-validated randomized predictive p-values, \"rpost\" posterior predictive p-values, \"mpost\" marginal posterior predictive p-values. Default \"iscv\". n.rep Integer; number replicated Z-residual sets generate. Default 1.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.poisson.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Z-Residuals for Poisson Models — Zresidual.poisson","text":"numeric matrix Z-residuals attributes: type: specified model component (currently NULL) zero_id: Indices zero outcomes log_pmf: Log-probability mass function values log_cdf: Log-cumulative distribution function values covariates: Model covariates linear.pred: Linear predictor values fitted model returned object class c(\"zresid\", \"matrix\").","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.poisson.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Z-Residuals for Poisson Models — Zresidual.poisson","text":"function performs following steps: Extracts observed response vector model data. Computes log-PMF log-CDF poisson model         using log.pred.dist.pois. Generates randomized posterior predictive p-values according         specified method. Converts p-values Z-residuals via negative quantile         standard normal distribution. output matrix Z-residuals one column per replication.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.poisson.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Z-Residuals for Poisson Models — Zresidual.poisson","text":"","code":"if (FALSE) { # \\dontrun{ # Compute Z-residuals for a poisson model zres_pois <- Zresidual.poisson(fit, method = \"iscv\")  # Compute Z-residuals with 2 replicates using posterior predictive p-values zres_pois_post <- Zresidual.poisson(fit, method = \"rpost\", n.rep = 2) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.survreg.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Z-residuals for a fitted survival regression model — Zresidual.survreg","title":"Calculate Z-residuals for a fitted survival regression model — Zresidual.survreg","text":"function calculates Z-residuals based fitted `survreg` object `survival` package.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.survreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Z-residuals for a fitted survival regression model — Zresidual.survreg","text":"","code":"Zresidual.survreg(fit_survreg, newdata, n.rep = 1)"},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.survreg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Z-residuals for a fitted survival regression model — Zresidual.survreg","text":"fit_survreg fitted object `survreg` function `survival` package. newdata optional data frame containing new observations calculate Z-residuals. `NULL` (default), residuals calculated data used fit model. n.rep integer specifying number random draws use calculating Z-residuals censored observations. Defaults `nrep` (defined environment, common choice 100).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.survreg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Z-residuals for a fitted survival regression model — Zresidual.survreg","text":"Survival.Prob: estimated survival probabilities. linear.pred: linear predictors survival regression model. covariates: covariate values used model. censored.status: censoring status (0 censored, 1 event). object.model.frame: model frame used analysis.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/Zresidual.survreg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Z-residuals for a fitted survival regression model — Zresidual.survreg","text":"","code":"library(survival)  # Fit a Weibull survival regression model fit_weibull <- survreg(Surv(time, status) ~ x, data = lung, dist = \"weibull\") #> Error in eval(predvars, data, env): object 'x' not found  # Calculate Z-residuals for the fitted model z_residuals <- Zresidual.survreg(fit_weibull) #> Error in Zresidual.survreg(fit_weibull): argument \"newdata\" is missing, with no default head(z_residuals) #> Error: object 'z_residuals' not found  # Calculate Z-residuals for new data new_data <- data.frame(x = c(1, 2, 0.5)) Z_residuals_new <- Zresidual.survreg(fit_weibull, newdata = new_data) #> Error: object 'fit_weibull' not found head(z_residuals_new) #> Error: object 'z_residuals_new' not found"},{"path":"https://tiw150.github.io/Zresidual/reference/aov.test.zresid.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to calculate ANOVA of Zresidual — aov.test.zresid","title":"A function to calculate ANOVA of Zresidual — aov.test.zresid","text":"function calculate ANOVA Zresidual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/aov.test.zresid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to calculate ANOVA of Zresidual — aov.test.zresid","text":"","code":"aov.test.zresid(Zresidual, X = c(\"lp\", \"covariate\"), k.anova = 10)"},{"path":"https://tiw150.github.io/Zresidual/reference/aov.test.zresid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to calculate ANOVA of Zresidual — aov.test.zresid","text":"Zresidual z-residual. X Linear predictor covariate k.anova Number bins applicable","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/bartlett.test.zresid.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to calculate Bartlett of Zresidual — bartlett.test.zresid","title":"A function to calculate Bartlett of Zresidual — bartlett.test.zresid","text":"function calculate Bartlett Zresidual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/bartlett.test.zresid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to calculate Bartlett of Zresidual — bartlett.test.zresid","text":"","code":"# S3 method for class 'zresid' bartlett.test(Zresidual, X = c(\"lp\", \"covariate\"), k.bl = 10)"},{"path":"https://tiw150.github.io/Zresidual/reference/bartlett.test.zresid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to calculate Bartlett of Zresidual — bartlett.test.zresid","text":"Zresidual Z-residual. X Linear predictor covariate k.bl Number bins applicable","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/boxplot.zresid.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to draw box plot of a z-residual — boxplot.zresid","title":"A function to draw box plot of a z-residual — boxplot.zresid","text":"function draw box plot z-residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/boxplot.zresid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to draw box plot of a z-residual — boxplot.zresid","text":"","code":"# S3 method for class 'zresid' boxplot(   Zresidual,   irep = 1,   X = c(\"lp\", \"covariate\"),   num.bin = 10,   normality.test = c(\"SW\", \"AOV\", \"BL\"),   k.test = 10,   main.title = paste(\"Z-residual Boxplot -\", attr(Zresidual, \"type\")),   outlier.return = FALSE,   outlier.value = 3.5,   ... )"},{"path":"https://tiw150.github.io/Zresidual/reference/boxplot.zresid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to draw box plot of a z-residual — boxplot.zresid","text":"Zresidual z-residual.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tnb.html","id":null,"dir":"Reference","previous_headings":"","what":"Cumulative Distribution Function (CDF) of Zero-Truncated Negative Binomial Distribution — cdf.tnb","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Negative Binomial Distribution — cdf.tnb","text":"Computes cumulative distribution function (CDF) zero-truncated negative binomial (TNB) distribution. function adjusts standard negative binomial CDF account truncation zero (.e., supports \\(y > 0\\)).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tnb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Negative Binomial Distribution — cdf.tnb","text":"","code":"cdf.tnb(y, mu, size, lower.tail = FALSE, log.p = FALSE)"},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tnb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Negative Binomial Distribution — cdf.tnb","text":"y Numeric vector quantiles (count values) compute CDF. mu Mean parameter (\\(\\mu\\)) negative binomial distribution. size Dispersion (shape) parameter (\\(r\\)) negative binomial distribution. lower.tail Logical; TRUE (default), probabilities \\(P(Y \\le y)\\). FALSE, probabilities \\(P(Y > y)\\). log.p Logical; TRUE, probabilities \\(p\\) given \\(\\log(p)\\).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tnb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Negative Binomial Distribution — cdf.tnb","text":"numeric vector length input, containing: CDF values (\\(P(Y \\le y \\mid Y > 0)\\)) lower.tail = TRUE. Upper-tail probabilities (\\(P(Y > y \\mid Y > 0)\\)) lower.tail = FALSE. Log-probabilities log.p = TRUE.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tnb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Negative Binomial Distribution — cdf.tnb","text":"function computes probabilities zero-truncated version negative binomial distribution: $$P(Y \\le y \\mid Y > 0) = \\frac{P(Y \\le y) - P(Y = 0)}{1 - P(Y = 0)}.$$ Internally, implemented using log-scale numerical stability. lower.tail = FALSE, computes upper-tail probabilities \\(P(Y > y \\mid Y > 0)\\) instead.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tnb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Negative Binomial Distribution — cdf.tnb","text":"","code":"# Example: Compute the CDF for y = 1:5 mu <- 2 size <- 1 cdf.tnb(1:5, mu, size) #> Error in cdf.tnb(1:5, mu, size): could not find function \"cdf.tnb\"  # Compute the upper-tail probabilities cdf.tnb(1:5, mu, size, lower.tail = FALSE) #> Error in cdf.tnb(1:5, mu, size, lower.tail = FALSE): could not find function \"cdf.tnb\"  # Log probabilities cdf.tnb(1:5, mu, size, log.p = TRUE) #> Error in cdf.tnb(1:5, mu, size, log.p = TRUE): could not find function \"cdf.tnb\""},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tp.html","id":null,"dir":"Reference","previous_headings":"","what":"Cumulative Distribution Function (CDF) of Zero-Truncated Poisson Distribution — cdf.tp","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Poisson Distribution — cdf.tp","text":"Computes cumulative distribution function (CDF) zero-truncated Poisson (TP) distribution. function modifies standard Poisson CDF account truncation zero (.e., supports \\(y > 0\\)).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Poisson Distribution — cdf.tp","text":"","code":"cdf.tp(y, lambda, lower.tail = FALSE, log.p = FALSE)"},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Poisson Distribution — cdf.tp","text":"y Numeric vector quantiles (count values) compute CDF. lambda Numeric vector scalar giving mean parameter (\\(\\lambda\\)) Poisson distribution. lower.tail Logical; TRUE (default), probabilities \\(P(Y \\le y)\\). FALSE, probabilities \\(P(Y > y)\\). log.p Logical; TRUE, probabilities \\(p\\) given \\(\\log(p)\\).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Poisson Distribution — cdf.tp","text":"numeric vector length input, containing: CDF values (\\(P(Y \\le y \\mid Y > 0)\\)) lower.tail = TRUE. Upper-tail probabilities (\\(P(Y > y \\mid Y > 0)\\)) lower.tail = FALSE. Log-probabilities log.p = TRUE.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Poisson Distribution — cdf.tp","text":"function computes probabilities zero-truncated version Poisson distribution: $$P(Y \\le y \\mid Y > 0) = \\frac{P(Y \\le y) - P(Y = 0)}{1 - P(Y = 0)}.$$ Internally, uses ppois() function base R computing Poisson probabilities, performs calculations log scale improved numerical stability. lower.tail = FALSE, returns upper-tail probabilities \\(P(Y > y \\mid Y > 0)\\) instead.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/cdf.tp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cumulative Distribution Function (CDF) of Zero-Truncated Poisson Distribution — cdf.tp","text":"","code":"# Example: Compute the zero-truncated Poisson CDF for y = 1:5 lambda <- 2 cdf.tp(1:5, lambda) #> Error in cdf.tp(1:5, lambda): could not find function \"cdf.tp\"  # Compute upper-tail probabilities cdf.tp(1:5, lambda, lower.tail = FALSE) #> Error in cdf.tp(1:5, lambda, lower.tail = FALSE): could not find function \"cdf.tp\"  # Compute log-CDF values cdf.tp(1:5, lambda, log.p = TRUE) #> Error in cdf.tp(1:5, lambda, log.p = TRUE): could not find function \"cdf.tp\""},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.nb.html","id":null,"dir":"Reference","previous_headings":"","what":"Probability Mass Function of the Hurdle Negative Binomial Distribution — dhurdle.nb","title":"Probability Mass Function of the Hurdle Negative Binomial Distribution — dhurdle.nb","text":"Computes probability (log-probability) observing count \\(y\\) hurdle model Bernoulli process zeros truncated Negative Binomial distribution positive counts (\\(y > 0\\)).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.nb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probability Mass Function of the Hurdle Negative Binomial Distribution — dhurdle.nb","text":"","code":"dhurdle.nb(y, mu, size, pi, log = FALSE)"},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.nb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Probability Mass Function of the Hurdle Negative Binomial Distribution — dhurdle.nb","text":"y Numeric vector observed count values. mu Mean parameter (\\(\\mu\\)) Negative Binomial component. size Dispersion (shape) parameter (\\(r\\)) Negative Binomial component. pi Probability observing structural zero (hurdle component). log Logical; TRUE, probabilities \\(p\\) returned log scale.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.nb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Probability Mass Function of the Hurdle Negative Binomial Distribution — dhurdle.nb","text":"numeric vector : Probabilities \\(P(Y = y)\\) log = FALSE. Log-probabilities \\(\\log P(Y = y)\\) log = TRUE.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.nb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Probability Mass Function of the Hurdle Negative Binomial Distribution — dhurdle.nb","text":"hurdle Negative Binomial (HNB) distribution models counts \\(Y\\) : $$ P(Y = 0) = \\pi, $$ $$ P(Y = y) = (1 - \\pi) \\frac{f_{NB}(y)}{1 - f_{NB}(0)}, \\quad \\text{} y > 0, $$ \\(f_{NB}(y)\\) Negative Binomial probability mass function parameters \\(\\mu\\) \\(r\\) (dispersion). Internally, computations performed log scale numerical stability. function handles vectorized inputs returns numeric vector length y.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.nb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Probability Mass Function of the Hurdle Negative Binomial Distribution — dhurdle.nb","text":"","code":"# Example parameters mu <- 2 size <- 1 pi <- 0.3  # Compute hurdle NB probabilities for counts 0–5 dhurdle.nb(0:5, mu, size, pi) #> Error in dhurdle.nb(0:5, mu, size, pi): could not find function \"dhurdle.nb\"  # Log-scale probabilities dhurdle.nb(0:5, mu, size, pi, log = TRUE) #> Error in dhurdle.nb(0:5, mu, size, pi, log = TRUE): could not find function \"dhurdle.nb\"  # Compare structural zero vs positive counts dhurdle.nb(0, mu, size, pi)      # P(Y = 0) #> Error in dhurdle.nb(0, mu, size, pi): could not find function \"dhurdle.nb\" dhurdle.nb(1, mu, size, pi)      # P(Y = 1) #> Error in dhurdle.nb(1, mu, size, pi): could not find function \"dhurdle.nb\""},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.pois.html","id":null,"dir":"Reference","previous_headings":"","what":"Probability Mass Function of the Hurdle Poisson Distribution — dhurdle.pois","title":"Probability Mass Function of the Hurdle Poisson Distribution — dhurdle.pois","text":"Computes probability density (log-density) Poisson hurdle distribution. distribution combines point mass zero truncated--zero Poisson distribution positive counts.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.pois.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probability Mass Function of the Hurdle Poisson Distribution — dhurdle.pois","text":"","code":"dhurdle.pois(y, lambda, pi, log = FALSE)"},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.pois.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Probability Mass Function of the Hurdle Poisson Distribution — dhurdle.pois","text":"y Numeric vector observed counts. lambda Numeric vector Poisson mean parameters (must positive). pi Numeric vector hurdle probabilities (probability structural zeros), value must 0 1. log Logical; TRUE, probabilities returned log scale.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.pois.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Probability Mass Function of the Hurdle Poisson Distribution — dhurdle.pois","text":"numeric vector length y, giving density (log-density) Poisson hurdle distribution.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.pois.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Probability Mass Function of the Hurdle Poisson Distribution — dhurdle.pois","text":"hurdle Poisson distribution assumes: $$ P(Y = 0) = \\pi $$ \\(y > 0\\): $$ P(Y = y) = (1 - \\pi) \\frac{P_{\\text{Pois}}(Y = y)}{1 - P_{\\text{Pois}}(Y = 0)} $$ \\(P_{\\text{Pois}}(Y = y)\\) standard Poisson probability mass function. function vectorized parameters.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/dhurdle.pois.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Probability Mass Function of the Hurdle Poisson Distribution — dhurdle.pois","text":"","code":"# Example usage: y <- 0:5 lambda <- 2 pi <- 0.3 dhurdle.pois(y, lambda, pi) #> Error in dhurdle.pois(y, lambda, pi): could not find function \"dhurdle.pois\" dhurdle.pois(y, lambda, pi, log = TRUE) #> Error in dhurdle.pois(y, lambda, pi, log = TRUE): could not find function \"dhurdle.pois\""},{"path":"https://tiw150.github.io/Zresidual/reference/gof.censored.zresidual.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to perform a goodness-of-fit test on censored Z-residuals. — gof.censored.zresidual","title":"A function to perform a goodness-of-fit test on censored Z-residuals. — gof.censored.zresidual","text":"function perform goodness--fit test censored Z-residuals.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/gof.censored.zresidual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to perform a goodness-of-fit test on censored Z-residuals. — gof.censored.zresidual","text":"","code":"gof.censored.zresidual(censored.Zresidual)"},{"path":"https://tiw150.github.io/Zresidual/reference/gof.censored.zresidual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to perform a goodness-of-fit test on censored Z-residuals. — gof.censored.zresidual","text":"censored.Zresidual censored Z-residuals tested.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/iscv_logrpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Log Randomized Predictive p-values using ISCV Method — iscv_logrpp","title":"Compute Log Randomized Predictive p-values using ISCV Method — iscv_logrpp","text":"Calculates log randomized predictive p-values (log-RPPs) based Importance Sampling Cross-Validation (ISCV) method, using precomputed log cumulative distribution function (log-CDF) log probability mass function (log-PMF) values.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/iscv_logrpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Log Randomized Predictive p-values using ISCV Method — iscv_logrpp","text":"","code":"iscv_logrpp(log_cdf, log_pmf)"},{"path":"https://tiw150.github.io/Zresidual/reference/iscv_logrpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Log Randomized Predictive p-values using ISCV Method — iscv_logrpp","text":"log_cdf numeric matrix log-CDF values dimensions \\(M \\times N\\), \\(M\\) number posterior draws \\(N\\) number observations. log_pmf numeric matrix log-PMF values dimensions log_cdf.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/iscv_logrpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Log Randomized Predictive p-values using ISCV Method — iscv_logrpp","text":"numeric vector length \\(N\\), giving log randomized predictive p-values observation.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/iscv_logrpp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Log Randomized Predictive p-values using ISCV Method — iscv_logrpp","text":"function implements Importance Sampling Cross-Validation (ISCV) version log randomized predictive p-value (log-RPP) computation. uses numerically stable log-sum-exp operations avoid overflow underflow summing log space. Randomized predictive p-values (\\(rpp\\)) computed using uniform random draws \\(u_i \\sim \\text{Uniform}(0,1)\\), combined model-predicted \\(\\text{CDF}\\) \\(\\text{PMF}\\) values observation posterior sample. result returned log scale numerical stability. Internally, function: Generates uniform random values \\(u_i\\) observation. Computes \\(\\log(u_i)\\) adds \\(\\log(\\text{PMF})\\). Applies numerically stable log-sum-exp operations column-wise. Values numerically equal 0 1 replaced \\(\\log(1e-5)\\) \\(\\log(9e-5)\\) respectively keep calculations stable.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/iscv_logrpp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Log Randomized Predictive p-values using ISCV Method — iscv_logrpp","text":"","code":"# Example matrices (toy example) log_cdf <- matrix(log(pnorm(rnorm(20))), 4000, 5) log_pmf <- matrix(log(dnorm(rnorm(20))), 4000, 5) result <- iscv_logrpp(log_cdf, log_pmf) #> Error in iscv_logrpp(log_cdf, log_pmf): could not find function \"iscv_logrpp\" head(result) #> Error: object 'result' not found"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HNB.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Log Predictive Distributions for a Hurdle Negative Binomial Model of a 'brms' Fit — log.pred.dist.HNB","title":"Compute Log Predictive Distributions for a Hurdle Negative Binomial Model of a 'brms' Fit — log.pred.dist.HNB","text":"function calculates log probability mass function (log-PMF) log cumulative distribution function (log-CDF) observation fitted hurdle negative binomial model (fitted using brms). function extracts posterior samples model parameters evaluates predictive distributions across posterior draws.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HNB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Log Predictive Distributions for a Hurdle Negative Binomial Model of a 'brms' Fit — log.pred.dist.HNB","text":"","code":"# S3 method for class 'pred.dist.HNB' log(fit)"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HNB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Log Predictive Distributions for a Hurdle Negative Binomial Model of a 'brms' Fit — log.pred.dist.HNB","text":"fit fitted brms hurdle negative binomial model object. model must include distributional parameters mu, shape, hurdle probability zero.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HNB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Log Predictive Distributions for a Hurdle Negative Binomial Model of a 'brms' Fit — log.pred.dist.HNB","text":"list following components: lpmf_hat matrix log-PMF values (posterior samples × observations). lcdf_hat matrix log-CCDF values (posterior samples × observations). zero_id Indices observations zero counts. count_id Indices observations positive counts.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HNB.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Log Predictive Distributions for a Hurdle Negative Binomial Model of a 'brms' Fit — log.pred.dist.HNB","text":"posterior draw observation, function computes: lpmf_hat: Log predictive mass function values using dhurdle.nb(). lcdf_hat: Log cumulative distribution function values   using phurdle.nb() lower.tail = FALSE.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HNB.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Log Predictive Distributions for a Hurdle Negative Binomial Model of a 'brms' Fit — log.pred.dist.HNB","text":"","code":"if (FALSE) { # \\dontrun{ # Example usage: fit <- brm(bf(y ~ x1 + x2, hu ~ x1), family = hurdle_negbinomial(), data = mydata) pred_dist <- log.pred.dist.HNB(fit) str(pred_dist) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HP.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Log Predictive Distributions for a Hurdle Poisson Model of a 'brms' Fit — log.pred.dist.HP","title":"Compute Log Predictive Distributions for a Hurdle Poisson Model of a 'brms' Fit — log.pred.dist.HP","text":"function calculates log predictive mass function (log-PMF) log cumulative distribution function (log-CDF) observation fitted hurdle Poisson model (fitted using brms). function extracts posterior samples model parameters evaluates predictive distributions across posterior draws.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Log Predictive Distributions for a Hurdle Poisson Model of a 'brms' Fit — log.pred.dist.HP","text":"","code":"# S3 method for class 'pred.dist.HP' log(fit)"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Log Predictive Distributions for a Hurdle Poisson Model of a 'brms' Fit — log.pred.dist.HP","text":"fit fitted brms hurdle Poisson model object. model must include distributional parameters mu (mean parameter) hurdle probability zero.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Log Predictive Distributions for a Hurdle Poisson Model of a 'brms' Fit — log.pred.dist.HP","text":"list following components: lpmf_hat matrix log-PMF values (posterior samples × observations). lcdf_hat matrix log-CDF values (posterior samples × observations). zero_id Indices observations zero counts. count_id Indices observations positive counts.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Log Predictive Distributions for a Hurdle Poisson Model of a 'brms' Fit — log.pred.dist.HP","text":"posterior draw observation, function computes: lpmf_hat: Log predictive mass function values using dhurdle.pois(). lcdf_hat: Log cumulative distribution function values   using phurdle.pois() lower.tail = FALSE. function also identifies indices zero positive count responses.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.HP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Log Predictive Distributions for a Hurdle Poisson Model of a 'brms' Fit — log.pred.dist.HP","text":"","code":"if (FALSE) { # \\dontrun{ # Example usage: fit <- brm(bf(y ~ x1 + x2, hu ~ x1), family = hurdle_poisson(), data = mydata) pred_dist <- log.pred.dist.HP(fit) str(pred_dist) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.NB.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Log Predictive Distributions for a Negative Binomial Model of a 'brms' Fit — log.pred.dist.NB","title":"Compute Log Predictive Distributions for a Negative Binomial Model of a 'brms' Fit — log.pred.dist.NB","text":"function calculates log predictive mass function (log-PMF) log cumulative distribution function (log-CDF) observation fitted negative binomial model (fitted using brms). function extracts posterior samples distributional parameters evaluates predictive distributions across posterior draws.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.NB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Log Predictive Distributions for a Negative Binomial Model of a 'brms' Fit — log.pred.dist.NB","text":"","code":"# S3 method for class 'pred.dist.NB' log(fit)"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.NB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Log Predictive Distributions for a Negative Binomial Model of a 'brms' Fit — log.pred.dist.NB","text":"fit fitted brms negative binomial model object. model must include distributional parameters mu (mean parameter) shape (dispersion parameter).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.NB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Log Predictive Distributions for a Negative Binomial Model of a 'brms' Fit — log.pred.dist.NB","text":"list following components: lpmf_hat matrix log-PMF values (posterior samples × observations). lcdf_hat matrix log-CDF values (posterior samples × observations). zero_id Indices observations zero counts.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.NB.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Log Predictive Distributions for a Negative Binomial Model of a 'brms' Fit — log.pred.dist.NB","text":"posterior draw observation, function computes: lpmf_hat: Log predictive mass function values using dnbinom(). lcdf_hat: Log cumulative distribution function values   using pnbinom() lower.tail = FALSE. function also identifies indices zero-valued observations, can useful model diagnostic procedures Z-residuals posterior predictive checks.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.NB.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Log Predictive Distributions for a Negative Binomial Model of a 'brms' Fit — log.pred.dist.NB","text":"","code":"if (FALSE) { # \\dontrun{ # Example usage: fit <- brm(bf(y ~ x1 + x2), family = negbinomial(), data = mydata) pred_dist <- log.pred.dist.NB(fit) str(pred_dist) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TNB.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Log Predictive Distributions for a Truncated Negative Binomial Model of a 'brms' Fit — log.pred.dist.TNB","title":"Compute Log Predictive Distributions for a Truncated Negative Binomial Model of a 'brms' Fit — log.pred.dist.TNB","text":"function calculates log predictive mass function (log-PMF) log cumulative distribution function (log-CDF) observation fitted truncated negative binomial model (fitted using brms). function extracts posterior samples model’s distributional parameters evaluates predictive distributions across posterior draws.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TNB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Log Predictive Distributions for a Truncated Negative Binomial Model of a 'brms' Fit — log.pred.dist.TNB","text":"","code":"# S3 method for class 'pred.dist.TNB' log(fit)"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TNB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Log Predictive Distributions for a Truncated Negative Binomial Model of a 'brms' Fit — log.pred.dist.TNB","text":"fit fitted brms truncated negative binomial model object. model must include distributional parameters mu (mean parameter) shape (dispersion parameter).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TNB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Log Predictive Distributions for a Truncated Negative Binomial Model of a 'brms' Fit — log.pred.dist.TNB","text":"list following components: lpmf_hat matrix log-PMF values (posterior samples × observations). lcdf_hat matrix log-CDF values (posterior samples × observations).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TNB.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Log Predictive Distributions for a Truncated Negative Binomial Model of a 'brms' Fit — log.pred.dist.TNB","text":"posterior draw observation, function computes: lpmf_hat: Log predictive mass function values using pdf.tnb(). lcdf_hat: Log cumulative distribution function values   using cdf.tnb() lower.tail = FALSE.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TNB.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Log Predictive Distributions for a Truncated Negative Binomial Model of a 'brms' Fit — log.pred.dist.TNB","text":"","code":"if (FALSE) { # \\dontrun{ # Example usage: fit <- brm(bf(y | trunc(lb = 1) ~ x1 + x2), family = negbinomial(), data = mydata) pred_dist <- log.pred.dist.TNB(fit) str(pred_dist) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TP.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Log Predictive Distributions for a Truncated Poisson Model of a 'brms' Fit — log.pred.dist.TP","title":"Compute Log Predictive Distributions for a Truncated Poisson Model of a 'brms' Fit — log.pred.dist.TP","text":"function calculates log predictive mass function (log-PMF) log cumulative distribution function (log-CDF) observation fitted truncated Poisson model (fitted using brms). function extracts posterior samples model’s mean parameter evaluates predictive distributions across posterior draws.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Log Predictive Distributions for a Truncated Poisson Model of a 'brms' Fit — log.pred.dist.TP","text":"","code":"# S3 method for class 'pred.dist.TP' log(fit)"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Log Predictive Distributions for a Truncated Poisson Model of a 'brms' Fit — log.pred.dist.TP","text":"fit fitted brms truncated Poisson model object. model must include distributional parameter mu (mean parameter).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Log Predictive Distributions for a Truncated Poisson Model of a 'brms' Fit — log.pred.dist.TP","text":"list following components: lpmf_hat matrix log-PMF values (posterior samples × observations). lcdf_hat matrix log-CDF values (posterior samples × observations).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Log Predictive Distributions for a Truncated Poisson Model of a 'brms' Fit — log.pred.dist.TP","text":"posterior draw observation, function computes: lpmf_hat: Log predictive mass function values using pdf.tp.li(). lcdf_hat: Log cumulative distribution function values   using cdf.tp.li() lower.tail = FALSE.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.TP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Log Predictive Distributions for a Truncated Poisson Model of a 'brms' Fit — log.pred.dist.TP","text":"","code":"if (FALSE) { # \\dontrun{ # Example usage: fit <- brm(bf(y | trunc(lb = 1) ~ x1 + x2), family = poisson(), data = mydata) pred_dist <- log.pred.dist.TP(fit) str(pred_dist) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.bern.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Log Predictive Distributions for Logistic Regression of a 'brms' Fit — log.pred.dist.bern","title":"Compute Log Predictive Distributions for Logistic Regression of a 'brms' Fit — log.pred.dist.bern","text":"Calculates log probability mass function (log-PMF) log cumulative distribution function (log-CDF) logistic model based fitted 'brms' model.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.bern.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Log Predictive Distributions for Logistic Regression of a 'brms' Fit — log.pred.dist.bern","text":"","code":"# S3 method for class 'pred.dist.bern' log(fit)"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.bern.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Log Predictive Distributions for Logistic Regression of a 'brms' Fit — log.pred.dist.bern","text":"fit fitted model object brms.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.bern.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Log Predictive Distributions for Logistic Regression of a 'brms' Fit — log.pred.dist.bern","text":"list containing: lpmf_hat: numeric matrix log-PMF values (posterior draws × observations). lcdf_hat: numeric matrix log-CDF values (posterior draws × observations).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.bern.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Log Predictive Distributions for Logistic Regression of a 'brms' Fit — log.pred.dist.bern","text":"function extracts posterior predictions Bernoulli component (structural zeros) using posterior.pred() mean parameter (\"mu\"). observation: Computes log-PMF observed binary outcome. Computes log-CDF (upper-tail probability) observed outcome. produces matrices size \\(M \\times N\\), \\(M\\) number posterior draws \\(N\\) number observations.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.bern.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Log Predictive Distributions for Logistic Regression of a 'brms' Fit — log.pred.dist.bern","text":"","code":"# Assuming 'fit' is a fitted brms logistic model # pred_dist <- log.pred.dist.bern(fit) # lpmf_hat <- pred_dist$lpmf_hat # lcdf_hat <- pred_dist$lcdf_hat"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.pois.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Log Predictive Distributions for a Poisson Model of a 'brms' Fit — log.pred.dist.pois","title":"Compute Log Predictive Distributions for a Poisson Model of a 'brms' Fit — log.pred.dist.pois","text":"function calculates log predictive mass function (log-PMF) log cumulative distribution function (log-CDF) observation fitted Poisson model (fitted using brms). function extracts posterior samples model’s mean parameter evaluates predictive distributions across posterior draws.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.pois.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Log Predictive Distributions for a Poisson Model of a 'brms' Fit — log.pred.dist.pois","text":"","code":"# S3 method for class 'pred.dist.pois' log(fit)"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.pois.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Log Predictive Distributions for a Poisson Model of a 'brms' Fit — log.pred.dist.pois","text":"fit fitted brms Poisson model object. model must include distributional parameter mu (mean parameter).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.pois.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Log Predictive Distributions for a Poisson Model of a 'brms' Fit — log.pred.dist.pois","text":"list following components: lpmf_hat matrix log-PMF values (posterior samples × observations). lcdf_hat matrix log-CDF values (posterior samples × observations). zero_id Indices observations zero counts.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.pois.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Log Predictive Distributions for a Poisson Model of a 'brms' Fit — log.pred.dist.pois","text":"posterior draw observation, function computes: lpmf_hat: Log predictive mass function values using dpois(). lcdf_hat: Log cumulative distribution function values   using ppois() lower.tail = FALSE. function also identifies indices zero-valued observations.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.pois.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Log Predictive Distributions for a Poisson Model of a 'brms' Fit — log.pred.dist.pois","text":"","code":"if (FALSE) { # \\dontrun{ # Example usage: fit <- brm(bf(y ~ x1 + x2), family = poisson(), data = mydata) pred_dist <- log.pred.dist.pois(fit) str(pred_dist) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.zero.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to calculate log predictive distribution (pmf and cdf) of logistic component of a 'brm' fit — log.pred.dist.zero","title":"A function to calculate log predictive distribution (pmf and cdf) of logistic component of a 'brm' fit — log.pred.dist.zero","text":"function calculate log predictive distribution (pmf cdf) logistic component 'brm' fit","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.zero.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to calculate log predictive distribution (pmf and cdf) of logistic component of a 'brm' fit — log.pred.dist.zero","text":"","code":"# S3 method for class 'pred.dist.zero' log(fit)"},{"path":"https://tiw150.github.io/Zresidual/reference/log.pred.dist.zero.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to calculate log predictive distribution (pmf and cdf) of logistic component of a 'brm' fit — log.pred.dist.zero","text":"fit `brm` fit.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log_diff_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to compute the logarithm of the difference between the exponentials of two log values. — log_diff_exp","title":"A function to compute the logarithm of the difference between the exponentials of two log values. — log_diff_exp","text":"function compute logarithm difference exponentials two log values.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/log_diff_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to compute the logarithm of the difference between the exponentials of two log values. — log_diff_exp","text":"","code":"log_diff_exp(la, lb)"},{"path":"https://tiw150.github.io/Zresidual/reference/log_diff_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to compute the logarithm of the difference between the exponentials of two log values. — log_diff_exp","text":"la log value. lb log value.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/model.frame.coxph.html","id":null,"dir":"Reference","previous_headings":"","what":"An internal S3 method for model.matrix. — model.frame.coxph","title":"An internal S3 method for model.matrix. — model.frame.coxph","text":"internal S3 method model.matrix.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/model.frame.coxph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"An internal S3 method for model.matrix. — model.frame.coxph","text":"","code":"# S3 method for class 'coxph' model.frame(formula, ...)"},{"path":"https://tiw150.github.io/Zresidual/reference/model.frame.survreg.html","id":null,"dir":"Reference","previous_headings":"","what":"An internal S3 method for model.matrix. — model.frame.survreg","title":"An internal S3 method for model.matrix. — model.frame.survreg","text":"internal S3 method model.matrix.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/model.frame.survreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"An internal S3 method for model.matrix. — model.frame.survreg","text":"","code":"# S3 method for class 'survreg' model.frame(formula, ...)"},{"path":"https://tiw150.github.io/Zresidual/reference/model.matrix.coxph.html","id":null,"dir":"Reference","previous_headings":"","what":"An internal S3 method for model.matrix. — model.matrix.coxph","title":"An internal S3 method for model.matrix. — model.matrix.coxph","text":"internal S3 method model.matrix.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/model.matrix.coxph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"An internal S3 method for model.matrix. — model.matrix.coxph","text":"","code":"# S3 method for class 'coxph' model.matrix(object, data = NULL, contrast.arg = object$contrasts, ...)"},{"path":"https://tiw150.github.io/Zresidual/reference/model.matrix.survreg.html","id":null,"dir":"Reference","previous_headings":"","what":"An internal S3 method for model.matrix. — model.matrix.survreg","title":"An internal S3 method for model.matrix. — model.matrix.survreg","text":"internal S3 method model.matrix.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/model.matrix.survreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"An internal S3 method for model.matrix. — model.matrix.survreg","text":"","code":"# S3 method for class 'survreg' model.matrix(object, data, ...)"},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tnb.html","id":null,"dir":"Reference","previous_headings":"","what":"Probability Mass Function of the Zero-Truncated Negative Binomial Distribution — pdf.tnb","title":"Probability Mass Function of the Zero-Truncated Negative Binomial Distribution — pdf.tnb","text":"Computes probability mass function (PMF) log-PMF zero-truncated negative binomial (TNB) distribution. version excludes zeros rescales probabilities accordingly sum one positive counts .","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tnb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probability Mass Function of the Zero-Truncated Negative Binomial Distribution — pdf.tnb","text":"","code":"pdf.tnb(y, mu, size, log.p = FALSE)"},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tnb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Probability Mass Function of the Zero-Truncated Negative Binomial Distribution — pdf.tnb","text":"y Numeric vector observed count values (y > 0). mu Numeric vector mean parameters negative binomial distribution. size Numeric vector shape (dispersion) parameters. log.p Logical; TRUE, returns log probabilities instead probabilities.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tnb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Probability Mass Function of the Zero-Truncated Negative Binomial Distribution — pdf.tnb","text":"numeric vector probabilities (log-probabilities log.p = TRUE).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tnb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Probability Mass Function of the Zero-Truncated Negative Binomial Distribution — pdf.tnb","text":"zero-truncated negative binomial probability observation \\(y > 0\\) : $$ P(Y = y \\mid Y > 0) = \\frac{P(Y = y)}{1 - P(Y = 0)} $$ \\(P(Y = y)\\) \\(P(Y = 0)\\) evaluated using standard negative binomial PMF CDF, respectively. implementation uses dnbinom pnbinom computation. function automatically vectorizes inputs, ensuring output corresponds elementwise set parameters.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tnb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Probability Mass Function of the Zero-Truncated Negative Binomial Distribution — pdf.tnb","text":"","code":"# Example: Zero-truncated negative binomial probabilities y <- 1:5 mu <- 2 size <- 1.5 pdf.tnb(y, mu, size) #> Error in pdf.tnb(y, mu, size): could not find function \"pdf.tnb\"  # Log probabilities pdf.tnb(y, mu, size, log.p = TRUE) #> Error in pdf.tnb(y, mu, size, log.p = TRUE): could not find function \"pdf.tnb\""},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tp.html","id":null,"dir":"Reference","previous_headings":"","what":"Probability Mass Function of the Zero-Truncated Poisson Distribution — pdf.tp","title":"Probability Mass Function of the Zero-Truncated Poisson Distribution — pdf.tp","text":"Computes probability mass function (PMF) log-PMF zero-truncated Poisson (TP) distribution. version excludes zeros rescales probabilities sum one positive counts .","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probability Mass Function of the Zero-Truncated Poisson Distribution — pdf.tp","text":"","code":"pdf.tp(y, lambda, log.p = FALSE)"},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Probability Mass Function of the Zero-Truncated Poisson Distribution — pdf.tp","text":"y Numeric vector observed count values (y > 0). lambda Numeric vector rate parameters (mean Poisson distribution). log.p Logical; TRUE, returns log probabilities instead probabilities.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Probability Mass Function of the Zero-Truncated Poisson Distribution — pdf.tp","text":"numeric vector probabilities (log-probabilities log.p = TRUE).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Probability Mass Function of the Zero-Truncated Poisson Distribution — pdf.tp","text":"zero-truncated Poisson probability observation \\(y > 0\\) : $$ P(Y = y \\mid Y > 0) = \\frac{P(Y = y)}{1 - P(Y = 0)} $$ \\(P(Y = y)\\) \\(P(Y = 0)\\) evaluated using standard Poisson PMF CDF, respectively. function uses dpois ppois internally. function automatically vectorizes inputs probability corresponds elementwise provided parameter values.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/pdf.tp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Probability Mass Function of the Zero-Truncated Poisson Distribution — pdf.tp","text":"","code":"# Example: Zero-truncated Poisson probabilities y <- 1:5 lambda <- 2 pdf.tp(y, lambda) #> Error in pdf.tp(y, lambda): could not find function \"pdf.tp\"  # Log probabilities pdf.tp(y, lambda, log.p = TRUE) #> Error in pdf.tp(y, lambda, log.p = TRUE): could not find function \"pdf.tp\""},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.nb.html","id":null,"dir":"Reference","previous_headings":"","what":"Cumulative Distribution Function of the Hurdle Negative Binomial Distribution — phurdle.nb","title":"Cumulative Distribution Function of the Hurdle Negative Binomial Distribution — phurdle.nb","text":"Computes cumulative distribution function (CDF) logarithm hurdle negative binomial (HNB) distribution. hurdle model combines point mass zero truncated negative binomial distribution positive counts.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.nb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cumulative Distribution Function of the Hurdle Negative Binomial Distribution — phurdle.nb","text":"","code":"phurdle.nb(y, mu, size, pi, lower.tail = FALSE, log.p = FALSE)"},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.nb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cumulative Distribution Function of the Hurdle Negative Binomial Distribution — phurdle.nb","text":"y Numeric vector observed count values. mu Numeric vector mean parameters negative binomial distribution. size Numeric vector shape (dispersion) parameters negative binomial distribution. pi Numeric vector hurdle probabilities (probability structural zeros). lower.tail Logical; TRUE (default), probabilities \\(P(Y \\le y)\\); otherwise, \\(P(Y > y)\\). log.p Logical; TRUE, probabilities returned log scale.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.nb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cumulative Distribution Function of the Hurdle Negative Binomial Distribution — phurdle.nb","text":"numeric vector cumulative probabilities (log-probabilities log.p = TRUE).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.nb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cumulative Distribution Function of the Hurdle Negative Binomial Distribution — phurdle.nb","text":"hurdle negative binomial model assumes: $$ P(Y = 0) = \\pi, \\quad P(Y = y \\mid Y > 0) = (1 - \\pi) \\frac{F_{NB}(y)-F_{NB}(0)}{1 - F_{NB}(0)}, \\quad y > 0 $$ \\(F_{NB}(y)\\) CDF standard negative binomial distribution. function computes upper lower tail probabilities zeros positive counts using logarithmic form numerical stability. Internal helper functions (log_diff_exp, log_sum_exp) used handle differences sums log-scale probabilities safely.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.nb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cumulative Distribution Function of the Hurdle Negative Binomial Distribution — phurdle.nb","text":"","code":"# Example: Hurdle Negative Binomial CDF y <- 0:5 mu <- 2 size <- 1.5 pi <- 0.3 phurdle.nb(y, mu, size, pi) #> Error in phurdle.nb(y, mu, size, pi): could not find function \"phurdle.nb\"  # Upper tail probabilities on log scale phurdle.nb(y, mu, size, pi, lower.tail = FALSE, log.p = TRUE) #> Error in phurdle.nb(y, mu, size, pi, lower.tail = FALSE, log.p = TRUE): could not find function \"phurdle.nb\""},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.pois.html","id":null,"dir":"Reference","previous_headings":"","what":"Cumulative Distribution Function of the Hurdle Poisson Distribution — phurdle.pois","title":"Cumulative Distribution Function of the Hurdle Poisson Distribution — phurdle.pois","text":"Computes cumulative distribution function (CDF) logarithm hurdle Poisson (HP) distribution. hurdle model combines point mass zero truncated poisson distribution positive counts.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.pois.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cumulative Distribution Function of the Hurdle Poisson Distribution — phurdle.pois","text":"","code":"phurdle.pois(y, lambda, pi, lower.tail = FALSE, log.p = FALSE)"},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.pois.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cumulative Distribution Function of the Hurdle Poisson Distribution — phurdle.pois","text":"y Numeric vector observed count values. lambda Numeric vector mean parameters poisson distribution. pi Numeric vector hurdle probabilities (probability structural zeros). lower.tail Logical; TRUE (default), probabilities \\(P(Y \\le y)\\); otherwise, \\(P(Y > y)\\). log.p Logical; TRUE, probabilities returned log scale.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.pois.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cumulative Distribution Function of the Hurdle Poisson Distribution — phurdle.pois","text":"numeric vector cumulative probabilities (log-probabilities log.p = TRUE).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.pois.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cumulative Distribution Function of the Hurdle Poisson Distribution — phurdle.pois","text":"hurdle poisson model assumes: $$ P(Y = 0) = \\pi, \\quad P(Y = y \\mid Y > 0) = (1 - \\pi) \\frac{F_{Pois}(y)-F_{Pois}(0)}{1 - F_{Pois}(0)}, \\quad y > 0 $$ \\(F_{Pois}(y)\\) CDF standard possion distribution. function computes upper lower tail probabilities zeros positive counts using logarithmic form numerical stability. Internal helper functions (log_diff_exp, log_sum_exp) used handle differences sums log-scale probabilities safely.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/phurdle.pois.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cumulative Distribution Function of the Hurdle Poisson Distribution — phurdle.pois","text":"","code":"# Example: Hurdle Poisson CDF y <- 0:5 lambda <- 2 pi <- 0.3 phurdle.pois(y, lambda, pi) #> Error in phurdle.pois(y, lambda, pi): could not find function \"phurdle.pois\"  # Upper tail probabilities on log scale phurdle.pois(y, lambda, pi, lower.tail = FALSE, log.p = TRUE) #> Error in phurdle.pois(y, lambda, pi, lower.tail = FALSE, log.p = TRUE): could not find function \"phurdle.pois\""},{"path":"https://tiw150.github.io/Zresidual/reference/plot.cs.residual.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to draw scatter plot of a Cox-snell Residual — plot.cs.residual","title":"A function to draw scatter plot of a Cox-snell Residual — plot.cs.residual","text":"function draw scatter plot Cox-snell Residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/plot.cs.residual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to draw scatter plot of a Cox-snell Residual — plot.cs.residual","text":"","code":"# S3 method for class 'cs.residual' plot(   cs.residual,   ylab = \"Cumulative Hazard Function\",   main.title = \"Cox-Snell Residuals Scatterplot\",   outlier.return = FALSE,   ... )"},{"path":"https://tiw150.github.io/Zresidual/reference/plot.cs.residual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to draw scatter plot of a Cox-snell Residual — plot.cs.residual","text":"cs.residual numeric vector Cox-Snell residuals.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/plot.dev.resid.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to draw scatter plot of a Deviance Residual — plot.dev.resid","title":"A function to draw scatter plot of a Deviance Residual — plot.dev.resid","text":"function draw scatter plot Deviance Residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/plot.dev.resid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to draw scatter plot of a Deviance Residual — plot.dev.resid","text":"","code":"# S3 method for class 'dev.resid' plot(   Deviance.residual,   ylab = \"Deviance Residual\",   X = c(\"index\", \"lp\", \"covariate\"),   main.title = \"Deviance Residual Plot\",   outlier.return = FALSE,   ... )"},{"path":"https://tiw150.github.io/Zresidual/reference/plot.dev.resid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to draw scatter plot of a Deviance Residual — plot.dev.resid","text":"Deviance.residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/plot.martg.resid.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to draw scatter plot of a Martingale Residual — plot.martg.resid","title":"A function to draw scatter plot of a Martingale Residual — plot.martg.resid","text":"function draw scatter plot Martingale Residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/plot.martg.resid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to draw scatter plot of a Martingale Residual — plot.martg.resid","text":"","code":"# S3 method for class 'martg.resid' plot(   Martingale.residual,   ylab = \"Martingale Residual\",   X = c(\"index\", \"lp\", \"covariate\"),   main.title = \"Martingale Residual Plot\",   outlier.return = FALSE,   ... )"},{"path":"https://tiw150.github.io/Zresidual/reference/plot.martg.resid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to draw scatter plot of a Martingale Residual — plot.martg.resid","text":"Martingale.residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/plot.zresid.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to draw scatter plot of a Z-residual — plot.zresid","title":"A function to draw scatter plot of a Z-residual — plot.zresid","text":"function draw scatter plot Z-residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/plot.zresid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to draw scatter plot of a Z-residual — plot.zresid","text":"","code":"# S3 method for class 'zresid' plot(   Zresidual,   irep = 1:ncol(Zresidual),   ylab = \"Z-Residual\",   normality.test = c(\"SW\", \"AOV\", \"BL\"),   k.test = 10,   X = c(\"index\", \"covariate\", \"lp\"),   main.title = ifelse(is.null(attr(Zresidual, \"type\")), \"Z-residual Scatterplot\",     paste(\"Z-residual Scatterplot -\", attr(Zresidual, \"type\"))),   outlier.return = TRUE,   outlier.value = 3.5,   category = NULL,   outlier.set = list(),   xlab = NULL,   my.mar = c(5, 4, 4, 6) + 0.1,   ... )"},{"path":"https://tiw150.github.io/Zresidual/reference/plot.zresid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to draw scatter plot of a Z-residual — plot.zresid","text":"Zresidual Z-residual. outlier.set list parameters available symbols() text(). xlab Optional label x-axis. NULL (default), function determines label based 'X'. Accepts LaTeX code enclosed 'tex()' enhanced formatting using latex2exp package.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/post_logmpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Posterior Log Middle-value Predictive p-values (Log-MPP) — post_logmpp","title":"Compute Posterior Log Middle-value Predictive p-values (Log-MPP) — post_logmpp","text":"Calculates posterior log middle-value (0.5) predictive p-values (log-MPP) set observations given log-PMF log-CDF matrices obtained posterior predictive samples.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/post_logmpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Posterior Log Middle-value Predictive p-values (Log-MPP) — post_logmpp","text":"","code":"post_logmpp(log_cdf, log_pmf)"},{"path":"https://tiw150.github.io/Zresidual/reference/post_logmpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Posterior Log Middle-value Predictive p-values (Log-MPP) — post_logmpp","text":"log_cdf Numeric matrix log cumulative probabilities observation (posterior samples × observations). log_pmf Numeric matrix log probability mass function values observation (posterior samples × observations).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/post_logmpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Posterior Log Middle-value Predictive p-values (Log-MPP) — post_logmpp","text":"numeric vector log posterior mid-value predictive probabilities observation.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/post_logmpp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Posterior Log Middle-value Predictive p-values (Log-MPP) — post_logmpp","text":"function computes stabilized version posterior predictive p-values: sums log-CDF log-PMF across posterior samples using log-sum-exp numerical stability. Probabilities exactly equal 0 1 replaced small bounds (\\(10^{-5}\\) \\(9 \\cdot 10^{-5}\\)) avoid numerical issues computations.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/post_logmpp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Posterior Log Middle-value Predictive p-values (Log-MPP) — post_logmpp","text":"","code":"if (FALSE) { # \\dontrun{ # Assume log_cdf and log_pmf are matrices from posterior predictive draws log_mpp <- post_logmpp(log_cdf, log_pmf) head(exp(log_mpp))  # Posterior predictive probabilities } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/post_logrpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Posterior Log Randomized Predictive p-values (Log-RPP) — post_logrpp","title":"Compute Posterior Log Randomized Predictive p-values (Log-RPP) — post_logrpp","text":"Calculates posterior log randomized predictive p-values (log-RPP) set observations given log-PMF log-CDF matrices posterior predictive samples.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/post_logrpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Posterior Log Randomized Predictive p-values (Log-RPP) — post_logrpp","text":"","code":"post_logrpp(log_cdf, log_pmf)"},{"path":"https://tiw150.github.io/Zresidual/reference/post_logrpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Posterior Log Randomized Predictive p-values (Log-RPP) — post_logrpp","text":"log_cdf Numeric matrix log cumulative probabilities observation (posterior samples × observations). log_pmf Numeric matrix log probability mass function values observation (posterior samples × observations).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/post_logrpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Posterior Log Randomized Predictive p-values (Log-RPP) — post_logrpp","text":"numeric vector log randomized posterior predictive p-values observation.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/post_logrpp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Posterior Log Randomized Predictive p-values (Log-RPP) — post_logrpp","text":"function computes randomized posterior predictive p-values follows: uniform random number generated observation randomize probability zero counts. Probabilities exactly equal 0 1 replaced small bounds (\\(10^{-5}\\) \\(9 \\cdot 10^{-5}\\)) avoid numerical issues.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/post_logrpp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Posterior Log Randomized Predictive p-values (Log-RPP) — post_logrpp","text":"","code":"if (FALSE) { # \\dontrun{ # Assume log_cdf and log_pmf are matrices from posterior predictive draws log_rpp <- post_logrpp(log_cdf, log_pmf) head(exp(log_rpp))  # Randomized posterior predictive probabilities } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/posterior.pred.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Posterior Predicted Parameters from a Hurdle or Count Model — posterior.pred","title":"Extract Posterior Predicted Parameters from a Hurdle or Count Model — posterior.pred","text":"Computes posterior predicted values specified distributional parameter (e.g., mean, shape, hurdle probability) fitted Bayesian count hurdle model. function supports extracting parameters positive counts observations.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/posterior.pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Posterior Predicted Parameters from a Hurdle or Count Model — posterior.pred","text":"","code":"posterior.pred(fit, dpar, count.only = TRUE, mc_used)"},{"path":"https://tiw150.github.io/Zresidual/reference/posterior.pred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Posterior Predicted Parameters from a Hurdle or Count Model — posterior.pred","text":"fit fitted brms model object containing data, formula, MCMC posterior draws. dpar Character string specifying distributional parameter extract: \"mu\" (mean), \"shape\" (dispersion), \"zero\" (hurdle probability). count.Logical; TRUE (default), computes predicted parameters positive counts (y > 0); otherwise, includes observations.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/posterior.pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Posterior Predicted Parameters from a Hurdle or Count Model — posterior.pred","text":"numeric matrix predicted parameter values observation (columns)   posterior draw (rows).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/posterior.pred.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract Posterior Predicted Parameters from a Hurdle or Count Model — posterior.pred","text":"function performs following steps: Builds model matrix chosen parameter observation subset. Extracts corresponding posterior MCMC draws fitted model. Computes linear predictor via matrix multiplication draws model matrix. Applies link function associated parameter (e.g., logit, log) obtain         predicted parameter values natural scale.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/posterior.pred.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Posterior Predicted Parameters from a Hurdle or Count Model — posterior.pred","text":"","code":"if (FALSE) { # \\dontrun{ # Extract posterior predicted mean (mu) for all observations mu_pred <- posterior.pred(fit, dpar = \"mu\", count.only = TRUE)  # Extract hurdle probabilities pi_pred <- posterior.pred(fit, dpar = \"zero\", count.only = FALSE) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/pvalue.min.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to calculate the min p-value — pvalue.min","title":"A function to calculate the min p-value — pvalue.min","text":"function calculate min p-value","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/pvalue.min.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to calculate the min p-value — pvalue.min","text":"","code":"pvalue.min(pv)"},{"path":"https://tiw150.github.io/Zresidual/reference/pvalue.min.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to calculate the min p-value — pvalue.min","text":"pv","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/qqnorm.zresid.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to draw qq plot of a z-residual — qqnorm.zresid","title":"A function to draw qq plot of a z-residual — qqnorm.zresid","text":"function draw qq plot z-residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/qqnorm.zresid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to draw qq plot of a z-residual — qqnorm.zresid","text":"","code":"# S3 method for class 'zresid' qqnorm(   Zresidual,   irep = 1,   diagnosis.test = \"SW\",   main.title = ifelse(is.null(attr(Zresidual, \"type\")), \"Normal Q-Q Plot\",     paste(\"Normal Q-Q Plot -\", attr(Zresidual, \"type\"))),   xlab = \"Theoretical Quantiles\",   ylab = \"Sample Quantiles\",   outlier.return = TRUE,   outlier.value = 3.5,   outlier.set = list(),   my.mar = c(5, 4, 4, 6) + 0.1,   legend.settings = list(),   ... )"},{"path":"https://tiw150.github.io/Zresidual/reference/qqnorm.zresid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to draw qq plot of a z-residual — qqnorm.zresid","text":"Zresidual z-residual. diagnosis.test diagnosis test legend.settings list parameters available legend(). point.clr vector colors points. point.type vector type points. outlier.settings list parameters available symbols() text(). X.anova X variable run ANOVA selected diagnosis.test. Possible c(\"lp\", \"covariate\") k.anova Number bins X.anova 'covariates'.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/residuals.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to calculate other type of residual — residuals","title":"A function to calculate other type of residual — residuals","text":"function calculate type residual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/residuals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to calculate other type of residual — residuals","text":"","code":"residuals(   fit.object,   data,   residual.type = c(\"censored Z-residual\", \"Cox-Snell\", \"martingale\", \"deviance\") )"},{"path":"https://tiw150.github.io/Zresidual/reference/residuals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to calculate other type of residual — residuals","text":"censored.Zresidcensored Z-residual ucsunmodified CS residuals martgMartingale residuals devDeviance residuals","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/sf.test.zresid.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to calculate Shapiro-Francia test of Zresidual — sf.test.zresid","title":"A function to calculate Shapiro-Francia test of Zresidual — sf.test.zresid","text":"function calculate Shapiro-Francia test Zresidual","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/sf.test.zresid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to calculate Shapiro-Francia test of Zresidual — sf.test.zresid","text":"","code":"sf.test.zresid(Zresidual)"},{"path":"https://tiw150.github.io/Zresidual/reference/sf.test.zresid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to calculate Shapiro-Francia test of Zresidual — sf.test.zresid","text":"Zresidual Z-residual.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/sw.test.zresid.html","id":null,"dir":"Reference","previous_headings":"","what":"Shapiro-Wilk Normality Test for Z-Residuals — sw.test.zresid","title":"Shapiro-Wilk Normality Test for Z-Residuals — sw.test.zresid","text":"Performs Shapiro-Wilk test normality column matrix Z-residuals.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/sw.test.zresid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shapiro-Wilk Normality Test for Z-Residuals — sw.test.zresid","text":"","code":"sw.test.zresid(Zresidual, ...)"},{"path":"https://tiw150.github.io/Zresidual/reference/sw.test.zresid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Shapiro-Wilk Normality Test for Z-Residuals — sw.test.zresid","text":"Zresidual numeric matrix Z-residuals, column represents separate set residuals (e.g., different posterior predictive draws variables). ... Additional arguments.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/sw.test.zresid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Shapiro-Wilk Normality Test for Z-Residuals — sw.test.zresid","text":"numeric vector Shapiro-Wilk p-values, one column Zresidual.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/sw.test.zresid.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Shapiro-Wilk Normality Test for Z-Residuals — sw.test.zresid","text":"Infinite non-finite values handled replacing negative infinity -1e10 positive infinity 1e10. NaN remaining infinite values reported via messages.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/sw.test.zresid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Shapiro-Wilk Normality Test for Z-Residuals — sw.test.zresid","text":"","code":"if (FALSE) { # \\dontrun{ Zres <- matrix(rnorm(100), ncol=5) sw.pvals <- sw.test.zresid(Zres) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/test.nl.aov.html","id":null,"dir":"Reference","previous_headings":"","what":"ANOVA Test for Z-Residuals — test.nl.aov","title":"ANOVA Test for Z-Residuals — test.nl.aov","text":"Performs ANOVA test assess whether Z-residuals differ across levels covariate. Numeric covariates many distinct values discretized bins. Small empty bins removed testing.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/test.nl.aov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ANOVA Test for Z-Residuals — test.nl.aov","text":"","code":"test.nl.aov(Zresidual, fitted.value, k.anova = 10)"},{"path":"https://tiw150.github.io/Zresidual/reference/test.nl.aov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ANOVA Test for Z-Residuals — test.nl.aov","text":"Zresidual Numeric vector Z-residuals. fitted.value Numeric factor covariate test . k.anova Integer; maximum number bins discretize numeric covariate (default 10).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/test.nl.aov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ANOVA Test for Z-Residuals — test.nl.aov","text":"Numeric p-value ANOVA F-test effect covariate Z-residuals.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/test.nl.aov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ANOVA Test for Z-Residuals — test.nl.aov","text":"function handles covariates follows: fitted.value factor fewer k.anova unique values, treated categorical. Otherwise, numeric covariates binned k.anova bins using cut. Bins fewer 3 observations removed. insufficient bins remain, covariate log-transformed binned . ANOVA performed lm(Zresidual ~ binned_covariate) p-value first term returned.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/test.nl.aov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ANOVA Test for Z-Residuals — test.nl.aov","text":"","code":"if (FALSE) { # \\dontrun{ Zres <- rnorm(100) x <- runif(100) test.nl.aov(Zres, x, k.anova = 5) } # }"},{"path":"https://tiw150.github.io/Zresidual/reference/test.var.bartl.html","id":null,"dir":"Reference","previous_headings":"","what":"Bartlett Test for Homogeneity of Variances of Z-Residual — test.var.bartl","title":"Bartlett Test for Homogeneity of Variances of Z-Residual — test.var.bartl","text":"Performs Bartlett's test assess whether variance Z-residuals differs across levels covariate. Numeric covariates many distinct values binned, small empty bins removed testing.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/test.var.bartl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bartlett Test for Homogeneity of Variances of Z-Residual — test.var.bartl","text":"","code":"test.var.bartl(Zresidual, fitted.value, k.bl = 10)"},{"path":"https://tiw150.github.io/Zresidual/reference/test.var.bartl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bartlett Test for Homogeneity of Variances of Z-Residual — test.var.bartl","text":"Zresidual Numeric vector Z-residuals. fitted.value Numeric factor covariate test . k.bl Integer; number bins discretize numeric covariate (default 10).","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/test.var.bartl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bartlett Test for Homogeneity of Variances of Z-Residual — test.var.bartl","text":"Numeric p-value Bartlett's test homogeneity variances.","code":""},{"path":"https://tiw150.github.io/Zresidual/reference/test.var.bartl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bartlett Test for Homogeneity of Variances of Z-Residual — test.var.bartl","text":"function handles covariates follows: fitted.value factor fewer k.bl unique values, treated categorical. Otherwise, numeric covariates binned k.bl bins. Bins fewer 3 observations removed. insufficient bins remain, covariate log-transformed binned . Bartlett's test applied Z-residuals grouped factor binned covariate.","code":""},{"path":[]},{"path":"https://tiw150.github.io/Zresidual/reference/test.var.bartl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bartlett Test for Homogeneity of Variances of Z-Residual — test.var.bartl","text":"","code":"if (FALSE) { # \\dontrun{ Zres <- rnorm(100) x <- runif(100) test.var.bartl(Zres, x, k.bl = 5) } # }"}]
