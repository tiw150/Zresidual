# Z-residuals

Z-residual is a residual diagnosis tool for diagnosing survival models
and Bayesian models.

## Installation

You can install the development version of this package from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("tiw150/Zresidual")
```

## References

Li L, Wu T, Feng C. Model diagnostics for censored regression via
randomized survival probabilities. Statistics in Medicine. 2021; 40:
1482–1497. <https://doi.org/10.1002/sim.8852>

Wu, T., Li, L., & Feng, C. (2024). Z-residual diagnostic tool for
assessing covariate functional form in shared frailty models. Journal of
Applied Statistics, 52(1), 28–58.
<https://doi.org/10.1080/02664763.2024.2355551>

Wu, T., Feng, C., & Li, L. (2024). Cross-Validatory Z-Residual for
Diagnosing Shared Frailty Models. The American Statistician, 79(2),
198–211. <https://doi.org/10.1080/00031305.2024.2421370>

## Example

# Package index

## All functions

- [`CV.Zresidual()`](https://tiw150.github.io/Zresidual/reference/CV.Zresidual.md)
  : Cross-Validated Z-Residual Diagnostics for Survival Models
- [`CV.Zresidual.coxph()`](https://tiw150.github.io/Zresidual/reference/CV.Zresidual.coxph.md)
  : Cross-Validated Z-Residuals for Cox Proportional Hazards Models
- [`CV.Zresidual.coxph.frailty()`](https://tiw150.github.io/Zresidual/reference/CV.Zresidual.coxph.frailty.md)
  : Cross-Validated Z-Residuals for Shared Frailty Cox Models
- [`CV.Zresidual.survreg()`](https://tiw150.github.io/Zresidual/reference/CV.Zresidual.survreg.md)
  : Cross-Validated Z-Residuals for Parametric Survival Regression
  Models
- [`Zresidual()`](https://tiw150.github.io/Zresidual/reference/Zresidual.md)
  : Compute Z-Residuals for Survival and Bayesian Regression Models
- [`Zresidual.bernoulli()`](https://tiw150.github.io/Zresidual/reference/Zresidual.bernoulli.md)
  : Compute Z-Residuals for a Bernoulli/Logistic Model
- [`Zresidual.coxph()`](https://tiw150.github.io/Zresidual/reference/Zresidual.coxph.md)
  : Z-residuals for Cox proportional hazards models
- [`Zresidual.coxph.frailty()`](https://tiw150.github.io/Zresidual/reference/Zresidual.coxph.frailty.md)
  : Z-residuals for shared frailty Cox proportional hazards models
- [`Zresidual.hurdle.negbinomial()`](https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.negbinomial.md)
  : Compute Z-Residuals for Hurdle or Count Negative Binomial Models
- [`Zresidual.hurdle.poisson()`](https://tiw150.github.io/Zresidual/reference/Zresidual.hurdle.poisson.md)
  : Compute Z-Residuals for Hurdle or Count Poisson Models
- [`Zresidual.negbinomial()`](https://tiw150.github.io/Zresidual/reference/Zresidual.negbinomial.md)
  : Compute Z-Residuals for Negative Binomial Models
- [`Zresidual.poisson()`](https://tiw150.github.io/Zresidual/reference/Zresidual.poisson.md)
  : Compute Z-Residuals for Poisson Models
- [`Zresidual.survreg()`](https://tiw150.github.io/Zresidual/reference/Zresidual.survreg.md)
  : Z-residuals for Accelerated failure time model models
- [`aov.test.zresid()`](https://tiw150.github.io/Zresidual/reference/aov.test.zresid.md)
  : A function to calculate ANOVA of Zresidual
- [`bartlett.test(`*`<zresid>`*`)`](https://tiw150.github.io/Zresidual/reference/bartlett.test.zresid.md)
  : A function to calculate Bartlett of Zresidual
- [`boxplot(`*`<zresid>`*`)`](https://tiw150.github.io/Zresidual/reference/boxplot.zresid.md)
  : Boxplot of Z-Residuals
- [`cdf.tnb()`](https://tiw150.github.io/Zresidual/reference/cdf.tnb.md)
  : Cumulative Distribution Function (CDF) of Zero-Truncated Negative
  Binomial Distribution
- [`cdf.tp()`](https://tiw150.github.io/Zresidual/reference/cdf.tp.md) :
  Cumulative Distribution Function (CDF) of Zero-Truncated Poisson
  Distribution
- [`dhurdle.nb()`](https://tiw150.github.io/Zresidual/reference/dhurdle.nb.md)
  : Probability Mass Function of the Hurdle Negative Binomial
  Distribution
- [`dhurdle.pois()`](https://tiw150.github.io/Zresidual/reference/dhurdle.pois.md)
  : Probability Mass Function of the Hurdle Poisson Distribution
- [`gof.censored.zresidual()`](https://tiw150.github.io/Zresidual/reference/gof.censored.zresidual.md)
  : Goodness-of-fit test for censored Z-residuals
- [`iscv_logrpp()`](https://tiw150.github.io/Zresidual/reference/iscv_logrpp.md)
  : Compute Log Randomized Predictive p-values using ISCV Method
- [`log_diff_exp()`](https://tiw150.github.io/Zresidual/reference/log_diff_exp.md)
  : A function to compute the logarithm of the difference between the
  exponentials of two log values.
- [`log_pred_dist_HNB()`](https://tiw150.github.io/Zresidual/reference/log_pred_dist_HNB.md)
  : Compute Log Predictive Distributions for a Hurdle Negative Binomial
  Model of a 'brms' Fit
- [`log_pred_dist_HP()`](https://tiw150.github.io/Zresidual/reference/log_pred_dist_HP.md)
  : Compute Log Predictive Distributions for a Hurdle Poisson Model of a
  'brms' Fit
- [`log_pred_dist_NB()`](https://tiw150.github.io/Zresidual/reference/log_pred_dist_NB.md)
  : Compute Log Predictive Distributions for a Negative Binomial Model
  of a 'brms' Fit
- [`log_pred_dist_TNB()`](https://tiw150.github.io/Zresidual/reference/log_pred_dist_TNB.md)
  : Compute Log Predictive Distributions for a Truncated Negative
  Binomial Model of a 'brms' Fit
- [`log_pred_dist_TP()`](https://tiw150.github.io/Zresidual/reference/log_pred_dist_TP.md)
  : Compute Log Predictive Distributions for a Truncated Poisson Model
  of a 'brms' Fit
- [`log_pred_dist_bern()`](https://tiw150.github.io/Zresidual/reference/log_pred_dist_bern.md)
  : Compute Log Predictive Distributions for Logistic Regression of a
  'brms' Fit
- [`log_pred_dist_pois()`](https://tiw150.github.io/Zresidual/reference/log_pred_dist_pois.md)
  : Compute Log Predictive Distributions for a Poisson Model of a 'brms'
  Fit
- [`log_pred_dist_zero()`](https://tiw150.github.io/Zresidual/reference/log_pred_dist_zero.md)
  : A function to calculate log predictive distribution (pmf and cdf) of
  logistic component of a 'brm' fit
- [`pdf.tnb()`](https://tiw150.github.io/Zresidual/reference/pdf.tnb.md)
  : Probability Mass Function of the Zero-Truncated Negative Binomial
  Distribution
- [`pdf.tp()`](https://tiw150.github.io/Zresidual/reference/pdf.tp.md) :
  Probability Mass Function of the Zero-Truncated Poisson Distribution
- [`phurdle.nb()`](https://tiw150.github.io/Zresidual/reference/phurdle.nb.md)
  : Cumulative Distribution Function of the Hurdle Negative Binomial
  Distribution
- [`phurdle.pois()`](https://tiw150.github.io/Zresidual/reference/phurdle.pois.md)
  : Cumulative Distribution Function of the Hurdle Poisson Distribution
- [`plot(`*`<cs.residual>`*`)`](https://tiw150.github.io/Zresidual/reference/plot.cs.residual.md)
  : Cox–Snell residual plot for survival models
- [`plot(`*`<dev.resid>`*`)`](https://tiw150.github.io/Zresidual/reference/plot.dev.resid.md)
  : Plot deviance residuals for survival models
- [`plot(`*`<martg.resid>`*`)`](https://tiw150.github.io/Zresidual/reference/plot.martg.resid.md)
  : Plot martingale residuals for survival models
- [`plot.zresid()`](https://tiw150.github.io/Zresidual/reference/plot.zresid.md)
  : Plot Z-Residuals for Bayesian and Frequentist Count / Hurdle / Zero
  / Survival Models
- [`post_logmpp()`](https://tiw150.github.io/Zresidual/reference/post_logmpp.md)
  : Compute Posterior Log Middle-value Predictive p-values (Log-MPP)
- [`post_logrpp()`](https://tiw150.github.io/Zresidual/reference/post_logrpp.md)
  : Compute Posterior Log Randomized Predictive p-values (Log-RPP)
- [`posterior.pred()`](https://tiw150.github.io/Zresidual/reference/posterior.pred.md)
  : Extract Posterior Predicted Parameters from a Hurdle or Count Model
- [`pvalue.min()`](https://tiw150.github.io/Zresidual/reference/pvalue.min.md)
  : A function to calculate the min p-value
- [`qqnorm(`*`<zresid>`*`)`](https://tiw150.github.io/Zresidual/reference/qqnorm.zresid.md)
  : Normal Q-Q Plot for Z-Residuals with Outlier Detection and Normality
  Diagnostics
- [`residual.coxph()`](https://tiw150.github.io/Zresidual/reference/residual.coxph.md)
  : Residuals for Cox proportional hazards models
- [`residual.coxph.frailty()`](https://tiw150.github.io/Zresidual/reference/residual.coxph.frailty.md)
  : Residuals for shared frailty Cox proportional hazards models
- [`residual.survreg()`](https://tiw150.github.io/Zresidual/reference/residual.survreg.md)
  : Residuals for Accelerated failure time model models
- [`sf.test.zresid()`](https://tiw150.github.io/Zresidual/reference/sf.test.zresid.md)
  : A function to calculate Shapiro-Francia test of Zresidual
- [`surv_residuals()`](https://tiw150.github.io/Zresidual/reference/surv_residuals.md)
  : Residuals for supported survival models
- [`sw.test.zresid()`](https://tiw150.github.io/Zresidual/reference/sw.test.zresid.md)
  : Shapiro-Wilk Normality Test for Z-Residuals
- [`test.var.bartl()`](https://tiw150.github.io/Zresidual/reference/test.var.bartl.md)
  : Bartlett Test for Homogeneity of Variances of Z-Residual

# Articles

### How to use various features of the package.

- [Z-residual diagnostic tool for assessing covariate functional form in
  shared frailty
  models](https://tiw150.github.io/Zresidual/articles/zresidual_demo.md):
- [Cross-validatory Z-Residual for Diagnosing Shared Frailty
  Models](https://tiw150.github.io/Zresidual/articles/cv_zresidual_demo.md):
- [Z-residual Diagnosis for Logistic
  Regression](https://tiw150.github.io/Zresidual/articles/zresidual_logistic_demo.md):
- [Component-wise Z-residual Diagnosis for Bayesian Hurdle
  Models](https://tiw150.github.io/Zresidual/articles/hurdle_zresidual_demo.md):
