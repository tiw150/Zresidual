<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute Z-residuals via an S3 generic — Zresidual • Zresidual</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Compute Z-residuals via an S3 generic — Zresidual"><meta name="description" content='Zresidual() is an S3 generic for computing Z-residuals for a range of
survival and regression models. It currently supports Cox proportional
hazards models (coxph) with or without frailty terms, parametric survival
regression models (survreg), and Bayesian regression models fitted with
brms (brmsfit) for several common count and hurdle families.
The function inspects the fitted object, assigns an internal
model– and package–specific class (e.g. "coxph.survival",
"survreg.survival", "poisson.brms", "hurdle_poisson.brms"),
and dispatches to the corresponding Zresidual.*() method.'><meta property="og:description" content='Zresidual() is an S3 generic for computing Z-residuals for a range of
survival and regression models. It currently supports Cox proportional
hazards models (coxph) with or without frailty terms, parametric survival
regression models (survreg), and Bayesian regression models fitted with
brms (brmsfit) for several common count and hurdle families.
The function inspects the fitted object, assigns an internal
model– and package–specific class (e.g. "coxph.survival",
"survreg.survival", "poisson.brms", "hurdle_poisson.brms"),
and dispatches to the corresponding Zresidual.*() method.'><meta property="og:image" content="https://tiw150.github.io/Zresidual/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Zresidual</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/tiw150/Zresidual" aria-label="GitHub repository"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../changelog.html" aria-label="Changelog"><span class="fa fas fa-newspaper"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute Z-residuals via an S3 generic</h1>
      <small class="dont-index">Source: <a href="https://github.com/tiw150/Zresidual/blob/HEAD/R/Zresidual.R" class="external-link"><code>R/Zresidual.R</code></a></small>
      <div class="d-none name"><code>Zresidual.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>Zresidual()</code> is an S3 generic for computing Z-residuals for a range of
survival and regression models. It currently supports Cox proportional
hazards models (<code>coxph</code>) with or without frailty terms, parametric survival
regression models (<code>survreg</code>), and Bayesian regression models fitted with
<strong>brms</strong> (<code>brmsfit</code>) for several common count and hurdle families.</p>
<p>The function inspects the fitted object, assigns an internal
model– and package–specific class (e.g. <code>"coxph.survival"</code>,
<code>"survreg.survival"</code>, <code>"poisson.brms"</code>, <code>"hurdle_poisson.brms"</code>),
and dispatches to the corresponding <code>Zresidual.*()</code> method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Zresidual</span><span class="op">(</span><span class="va">object</span>, nrep <span class="op">=</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="st">"iscv"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A fitted model object. Currently supported objects include:</p><ul><li><p><code>"coxph"</code> – Cox proportional hazards model (from <strong>survival</strong>)</p></li>
<li><p><code>"survreg"</code> – Parametric survival regression (from <strong>survival</strong>)</p></li>
<li><p><code>"brmsfit"</code> – Bayesian regression model (from <strong>brms</strong>) with one of the
supported families listed under <strong>Details</strong>.</p></li>
</ul></dd>


<dt id="arg-nrep">nrep<a class="anchor" aria-label="anchor" href="#arg-nrep"></a></dt>
<dd><p>Integer. Number of replicated Z-residual samples to compute.
Default is <code>1</code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Optional data frame used for generating model predictions and
residuals. For some models (e.g. <code>coxph</code> with frailty terms) this should
match the data used to fit the model.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Optional character string. Residual type for hurdle and count
models (mainly used for <strong>brms</strong> and other Bayesian/count-model
interfaces). The interpretation of this argument is model-specific.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string indicating which predictive p-value
scheme to use when computing Z-residuals for Bayesian or simulation-based
models. Common options include <code>"iscv"</code> (importance-sampling
cross-validated), <code>"loocv"</code>, and <code>"posterior"</code>. The default is <code>"iscv"</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed on to model-specific methods
such as <code><a href="Zresidual.coxph.survival.html">Zresidual.coxph.survival()</a></code>,
<code><a href="Zresidual.survreg.survival.html">Zresidual.survreg.survival()</a></code>,
<code><a href="Zresidual.poisson.brms.html">Zresidual.poisson.brms()</a></code>, etc.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"zresid"</code> with additional class information inherited
from the model-specific method. The object contains the computed Z-residuals
and any model-specific diagnostic quantities returned by the underlying
<code>Zresidual.*()</code> implementation.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Internally, <code>Zresidual()</code> modifies the class of <code>object</code> to encode both the
model type and the fitting package, and then uses S3 method dispatch:</p><ul><li><p>For <strong>survival</strong> models</p><ul><li><p><code>coxph</code> objects receive the class <code>"coxph.survival"</code> and are handled by
<code><a href="Zresidual.coxph.survival.html">Zresidual.coxph.survival()</a></code>, which further distinguishes between models
with and without frailty terms.</p></li>
<li><p><code>survreg</code> objects receive the class <code>"survreg.survival"</code> and are handled
by <code><a href="Zresidual.survreg.survival.html">Zresidual.survreg.survival()</a></code>.</p></li>
</ul></li>
<li><p>For <strong>brms</strong> models</p><ul><li><p>The family is obtained via <code>family(object)$family</code>.</p></li>
<li><p>Currently supported families include
<code>"hurdle_negbinomial"</code>, <code>"hurdle_poisson"</code>,
<code>"negbinomial"</code>, <code>"poisson"</code>, and <code>"bernoulli"</code>.</p></li>
<li><p>Each supported family is mapped to a class of the form
<code>"&lt;family&gt;.brms"</code>, and dispatched to a method such as
<code><a href="Zresidual.hurdle_poisson.brms.html">Zresidual.hurdle_poisson.brms()</a></code>,
<code><a href="Zresidual.negbinomial.brms.html">Zresidual.negbinomial.brms()</a></code>,
<code><a href="Zresidual.poisson.brms.html">Zresidual.poisson.brms()</a></code>,
or <code><a href="Zresidual.bernoulli.brms.html">Zresidual.bernoulli.brms()</a></code>.</p></li>
</ul></li>
</ul><p>Additional model classes (e.g. <code>glmmTMB</code> fits) can be supported by defining
new S3 methods such as <code>Zresidual.poisson.glmmTMB()</code> and ensuring that
<code>Zresidual()</code> assigns the corresponding internal class
(for example <code>"poisson.glmmTMB"</code>).</p>
<p>If <code>object</code> does not match any supported model class, or if a <code>brmsfit</code>
object uses an unsupported family, <code>Zresidual()</code> raises an error.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Zresidual.coxph.survival(),
Zresidual.survreg.survival(),
Zresidual.hurdle_poisson.brms(),
Zresidual.hurdle_negbinomial.brms(),
Zresidual.negbinomial.brms(),
Zresidual.poisson.brms(),
Zresidual.bernoulli.brms(),
and related model-specific methods.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## Cox proportional hazards model</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_cox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">lung</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z_cox</span> <span class="op">&lt;-</span> <span class="fu">Zresidual</span><span class="op">(</span><span class="va">fit_cox</span>, nrep <span class="op">=</span> <span class="fl">10</span>, data <span class="op">=</span> <span class="va">lung</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Parametric survival regression</span></span></span>
<span class="r-in"><span><span class="va">fit_surv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span>,</span></span>
<span class="r-in"><span>                    data <span class="op">=</span> <span class="va">lung</span>, dist <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z_surv</span> <span class="op">&lt;-</span> <span class="fu">Zresidual</span><span class="op">(</span><span class="va">fit_surv</span>, nrep <span class="op">=</span> <span class="fl">5</span>, data <span class="op">=</span> <span class="va">lung</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Bayesian Poisson regression with brms</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_brms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z_brms</span> <span class="op">&lt;-</span> <span class="fu">Zresidual</span><span class="op">(</span><span class="va">fit_brms</span>, method <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tingxuan Wu, Longhai Li.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

