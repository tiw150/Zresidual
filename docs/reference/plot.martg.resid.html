<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot martingale residuals for survival models — plot.martg.resid • Zresidual</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Plot martingale residuals for survival models — plot.martg.resid"><meta name="description" content="Produce diagnostic plots for martingale residuals from survival models,
with the option to plot against the observation index, the linear predictor,
or a selected covariate. The function expects a vector (or one-column
matrix) of martingale residuals with attributes attached by the residual
computation functions in this package."><meta property="og:description" content="Produce diagnostic plots for martingale residuals from survival models,
with the option to plot against the observation index, the linear predictor,
or a selected covariate. The function expects a vector (or one-column
matrix) of martingale residuals with attributes attached by the residual
computation functions in this package."><meta property="og:image" content="https://tiw150.github.io/Zresidual/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Zresidual</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/tiw150/Zresidual" aria-label="GitHub repository"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../changelog.html" aria-label="Changelog"><span class="fa fas fa-newspaper"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot martingale residuals for survival models</h1>
      <small class="dont-index">Source: <a href="https://github.com/tiw150/Zresidual/blob/HEAD/R/plot.martg.resid.R" class="external-link"><code>R/plot.martg.resid.R</code></a></small>
      <div class="d-none name"><code>plot.martg.resid.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Produce diagnostic plots for martingale residuals from survival models,
with the option to plot against the observation index, the linear predictor,
or a selected covariate. The function expects a vector (or one-column
matrix) of martingale residuals with attributes attached by the residual
computation functions in this package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'martg.resid'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Martingale Residual"</span>,</span>
<span>  x_axis_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"index"</span>, <span class="st">"lp"</span>, <span class="st">"covariate"</span><span class="op">)</span>,</span>
<span>  main.title <span class="op">=</span> <span class="st">"Martingale Residual Plot"</span>,</span>
<span>  outlier.return <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Numeric vector (or one-column matrix) of
martingale residuals, typically returned by one of the residual
functions in this package with <code>residual.type = "martingale"</code>.
It must carry the attributes <code>"censored.status"</code>,
<code>"linear.pred"</code>, and <code>"covariates"</code> as described above.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>Character string for the y-axis label. Default is
<code>"Martingale Residual"</code>.</p></dd>


<dt id="arg-x-axis-var">x_axis_var<a class="anchor" aria-label="anchor" href="#arg-x-axis-var"></a></dt>
<dd><p>Character string controlling the x-axis. Must be one of
<code>"index"</code>, <code>"lp"</code>, <code>"covariate"</code>, or the name of a
covariate contained in <code>attr(x, "covariates")</code>.
The default is effectively <code>"lp"</code> if <code>x_axis_var</code> is not supplied.</p></dd>


<dt id="arg-main-title">main.title<a class="anchor" aria-label="anchor" href="#arg-main-title"></a></dt>
<dd><p>Character string for the main plot title. Default is
<code>"Martingale Residual Plot"</code>.</p></dd>


<dt id="arg-outlier-return">outlier.return<a class="anchor" aria-label="anchor" href="#arg-outlier-return"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, attempted outliers (as
indicated by an external logical vector <code>is.outlier</code> in the calling
environment) are highlighted in the plot and their indices are returned
invisibly. If <code>FALSE</code> (default), no outlier indices are returned.
Note that this function does not compute outliers internally: it assumes
that a logical vector <code>is.outlier</code> of the same length as
<code>x</code> is available if outlier highlighting is desired.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to the underlying plotting functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function is primarily called for its side-effect of producing a plot.
If <code>outlier.return = TRUE</code>, it prints the indices of outlying points
to the console and invisibly returns a list with component
<code>outliers</code>, containing the indices where <code>is.outlier</code> is
<code>TRUE</code>. Otherwise, it returns <code>NULL</code> invisibly.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The input <code>x</code> is typically obtained from
<code><a href="residual.coxph.html">residual.coxph()</a></code>, <code><a href="residual.coxph.frailty.html">residual.coxph.frailty()</a></code>, or
<code><a href="residual.survreg.html">residual.survreg()</a></code> with <code>residual.type = "martingale"</code>.</p>
<p>The <code>x_axis_var</code> argument controls the x-axis:</p><ul><li><p><code>"index"</code>: plot martingale residuals against observation index.</p></li>
<li><p><code>"lp"</code>: plot martingale residuals against the linear predictor
(attribute <code>"linear.pred"</code>).</p></li>
<li><p><code>"covariate"</code>: prompt the user and print the available
covariate names to the console.</p></li>
<li><p>a character string matching one of the covariate names in
<code>attr(x, "covariates")</code>: plot martingale residuals against that covariate.</p></li>
</ul><p>In the <code>"lp"</code> and covariate cases, a LOWESS smooth is added to the
plot to highlight systematic patterns in the residuals.</p>
<p>Non-finite martingale residuals are detected and truncated to lie slightly
beyond the largest finite residual, with a warning message printed to alert
the user that there may be problems with the model fit. Censored and
uncensored observations are distinguished by color and plotting symbol in
all display modes.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>residual.coxph</code>, <code>residual.coxph.frailty</code>,
<code>residual.survreg</code>, <code><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></code>,
<code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lung</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">lung</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="residual.coxph.html">residual.coxph</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">lung</span>,</span></span>
<span class="r-in"><span>                      residual.type <span class="op">=</span> <span class="st">"martingale"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Basic plot vs. index</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_m</span>, x_axis_var <span class="op">=</span> <span class="st">"index"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot vs. linear predictor</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_m</span>, x_axis_var <span class="op">=</span> <span class="st">"lp"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot vs. a specific covariate, e.g. "age"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_m</span>, x_axis_var <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tingxuan Wu, Longhai Li.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

