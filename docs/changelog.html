<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Change Logs for Zresidual Package • Zresidual</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" sizes="any" href="favicon.ico"><link rel="manifest" href="site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="katex-auto.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet"><meta property="og:title" content="Change Logs for Zresidual Package"><meta property="og:image" content="https://tiw150.github.io/Zresidual/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">Zresidual</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/tiw150/Zresidual" aria-label="GitHub repository"><span class="fa fa-github fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="changelog.html" aria-label="Changelog"><span class="fa fas fa-newspaper"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>Change Logs for Zresidual Package</h1>
      <small class="dont-index">Source: <a href="https://github.com/tiw150/Zresidual/blob/HEAD/changelog.md" class="external-link"><code>changelog.md</code></a></small>
    </div>

<div id="change-logs-for-zresidual-package" class="section level1">

<div class="section level3">
<h3 id="planned-tasks-on-december-19-2025">Planned Tasks on December 19, 2025<a class="anchor" aria-label="anchor" href="#planned-tasks-on-december-19-2025"></a></h3>
<ul><li>
<p>Improve vignettes like:</p>
<ul><li>
<code>$$Z_i =-\Phi^{-1} (RSP_i) $${#eq-rsp}</code>,</li>
<li>improve table, figure format and captions</li>
<li>more verbal descriptions of the experiments and results.</li>
</ul></li>
<li><p>In the vignettes, you can generate a large number like 1000 replicated Z-residuals so that the histograms look better, and the upper-bound p-values have more sample size. using the saved rds to save the pre-computed objects to inst/extdata to save the re-production time. See this: <a href="https://gemini.google.com/share/5362ba39f503" class="external-link uri">https://gemini.google.com/share/5362ba39f503</a></p></li>
<li><p>Use the upper-bound p-values for the median to summarize the replicated Z-residuals for all of them, even for the past works on survival Z-residuals. This is a more theoretically grounded method than p-min. Don’t use the min p-value, which confuses people. Use the name in the recent paper on this.</p></li>
<li><p>Sanitize the function names so that the names follow the generic.class convention, for example using log_pred.bern.brms, phurdle, ptruncnb, etc. The functions like pdf and cdf needs to be renamed to be consistent with conventional names dnorm.pnorm. If the function is applied to a class name, register an S3 method. Rename (refactor) all the messy function names. But need to change all of them in the packages. In RStudio, you can use edit-&gt; find in files to find all the function names in the whole directory. This may be the easiest way to change all these function names. I would recommend this permanent change for future developers. This step will need to be combined with future work in “refactoring Zresidual” discussed below.</p></li>
<li>
<p>Refactor Zresidual method and the subsequent worklows to be extensible for custom models</p>
<ul><li>
<p>The structure of the workflow is as follows:</p>
<p>model -&gt; log_pointpred_family_pkg -&gt; log_pred_pkg -&gt; Zresidual -&gt; Diagnose</p>
<p>Notes: the difference between log_pointpred_family_pkg and log_pred_pkg is for Bayesian models represented by MCMC sample. We need to summarize with posterior or ISCV to obtain the final aggregated predictive CDF and PMF. For frequentist models, the output (log_cdf, log_pmf) of log_pointpred_family_pkg are two vectors. Therefore the summmary stay the same. However, we can use this unified procedure in coding.</p>
</li>
<li>
<p>To refactor Zresidual to use the above workflow, we will need to do these:</p>
<ul><li><p>Rewrite and rename the lowest level functions to compute log_pred given pkg and family, eg, log_pointpred_bern_brms,log_pointpred_hurdleNB_brms, log_pointpred_coxph,log_pointpred_weibull_survreg. The family name and pkg names and be retrieve from the model object.</p></li>
<li><p>Rewrite the method Zresidual to take input from class <code>log_pred</code>: (<code>log_cdf</code>, <code>log_pmf</code>, both <strong>vectors</strong>, and optional <code>data</code>, which includes <code>lp</code>, and <code>covariates</code>, which is needed for plot and stat tests), .</p></li>
<li><p>To generally support naive cross-validation or external residuals, in the step from model to log_pred_family_pkg or log_mcmcpred_family_pkg, we should allow a testdata arugment, which could be an external <code>testdata</code>. If <code>testdata</code> is null, it will be the <code>data</code> from model obj, ie, training data</p></li>
<li><p>It is good to define %&gt;% operator for the above workflow. We also provide short-cut function like Zredidual(model, …) to do these steps.</p></li>
<li><p>If the obj to Zresidual is a specific model (e.g, brms for hurdle etc.), find or call lower level functions directly, such as log_pointpred.brms, to compute Z-residuals. Before finishing the whole refactoring process, we can leave hard-redirction to a specific function so that the current code work. Remove these hard-redirection after refactoring of the lower-level functions are done.</p></li>
<li><p>The argument “type” and “method” are only for the <code>log_pointpred_hurdle_brms</code> functions, not for Zresidual. The Zresidual method essential only repeat the calculation of multiple Z-residuals by using repeated random draws of U_i. But these arguments can be passed down to lower-level functions if it is called with Zresidual(model, …). The <code>type</code> should be renamed as <code>zr.type.hurdle</code>, and the <code>method</code> should be renamed as <code>sum.mcmc.method</code> which could be <code>post</code> or <code>iscv</code>.</p></li>
<li><p>The MPP method is coded as an option in the highest level Zresidual method with an argument called <code>randomized</code>. If <code>randomized=FALSE</code>, <span class="math inline">U_i=0.5</span>, and <code>nrep</code> argument takes no effect as there is no need to replicate Z-residual.</p></li>
</ul></li>
</ul></li>
<li>
<p>Organize the function list</p>
<ul><li>
<p>Add @concept tags to each function, then the reference list will be organized. Example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#' @concept Zresidual</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#' @concept visualization</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#' @concept log_pred</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#' @concept test</span></span></code></pre></div>
</li>
<li>
<p>add such lines to the _pkgdown.yaml:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>reference<span class="sc">:</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="sc">-</span> title<span class="sc">:</span> <span class="st">"Visualization"</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    desc<span class="sc">:</span> <span class="st">"Functions for visualizing entropy contributions and model noise."</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    contents<span class="sc">:</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>      <span class="sc">-</span> <span class="fu">has_concept</span>(<span class="st">"visualization"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="sc">-</span> title<span class="sc">:</span> <span class="st">"Tabulation"</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    desc<span class="sc">:</span> <span class="st">"Functions for formatting, printing, and exporting results tables."</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    contents<span class="sc">:</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>      <span class="sc">-</span> <span class="fu">has_concept</span>(<span class="st">"tabulation"</span>)</span></code></pre></div>
<p>The pkgdown will then organize the functions by concept. A function can have multiple concepts.</p>
</li>
</ul></li>
<li>
<p>Refactor Bayesian workflow</p>
<p>The function post_logrpp, iscv_logrpp etc need to be changed with U_i removed and merged into log_pred_pkg, which will return only log_cdf/log_pmf (post or iscv), which will then be passed to Zresidual to generate replicated Z-residual with random draws of U_i. Once Zresidual method is modified to take only log_cdf and log_pmf as inputs, the following calculation is fast.</p>
</li>
<li><p>Make generic function to compute Z-residual-based PPC p-values for log_pointpred object, which is an object of log_cdf and log_pmf for each MCMC samples</p></li>
</ul></div>
</div>

  </main></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tingxuan Wu, Longhai Li.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

