% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dhurdlenb.R
\name{dhurdlenb}
\alias{dhurdlenb}
\title{Probability Mass Function of the Hurdle Negative Binomial Distribution}
\usage{
dhurdlenb(y, mu, size, pi, log = FALSE)
}
\arguments{
\item{y}{Numeric vector of observed count values.}

\item{mu}{Mean parameter (\eqn{\mu}) of the Negative Binomial component.}

\item{size}{Dispersion (shape) parameter (\eqn{r}) of the Negative Binomial component.}

\item{pi}{Probability of observing a structural zero (from the hurdle component).}

\item{log}{Logical; if \code{TRUE}, probabilities \eqn{p} are returned on the log scale.}
}
\value{
A numeric vector of:
\itemize{
\item Probabilities \eqn{P(Y = y)} if \code{log = FALSE}.
\item Log-probabilities \eqn{\log P(Y = y)} if \code{log = TRUE}.
}
}
\description{
Computes the probability (or log-probability) of observing a count \eqn{y} under
a hurdle model with a Bernoulli process for zeros and a truncated Negative Binomial
distribution for positive counts (\eqn{y > 0}).
}
\details{
The hurdle Negative Binomial (HNB) distribution models counts \eqn{Y} as:

\deqn{
P(Y = 0) = \pi,
}
\deqn{
P(Y = y) = (1 - \pi) \frac{f_{NB}(y)}{1 - f_{NB}(0)}, \quad \text{for } y > 0,
}

where \eqn{f_{NB}(y)} is the Negative Binomial probability mass function with parameters
\eqn{\mu} and \eqn{r} (dispersion).

Internally, computations are performed on the log scale for numerical stability.
The function handles vectorized inputs and returns a numeric vector of the same length as \code{y}.
}
\examples{
# Example parameters
mu <- 2
size <- 1
pi <- 0.3

# Compute hurdle NB probabilities for counts 0â€“5
dhurdlenb(0:5, mu, size, pi)

# Log-scale probabilities
dhurdlenb(0:5, mu, size, pi, log = TRUE)

# Compare structural zero vs positive counts
dhurdlenb(0, mu, size, pi)      # P(Y = 0)
dhurdlenb(1, mu, size, pi)      # P(Y = 1)
}
\seealso{
\code{\link[stats]{dnbinom}} for the Negative Binomial PMF,
\code{\link[stats]{pnbinom}} for its CDF.
}
