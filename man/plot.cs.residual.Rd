% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.cs.residual.R
\name{plot.cs.residual}
\alias{plot.cs.residual}
\title{Cox–Snell residual plot for survival models}
\usage{
\method{plot}{cs.residual}(
  x,
  ylab = "Cumulative Hazard Function",
  main.title = "Cox-Snell Residuals Scatterplot",
  outlier.return = FALSE,
  ...
)
}
\arguments{
\item{x}{Numeric vector (or one-column matrix) of Cox–Snell
residuals, typically returned by one of the residual functions in this
package with \code{residual.type = "Cox-Snell"}. It must carry the
attribute \code{"censored.status"}, giving the event indicator
(1 = event, 0 = censored).}

\item{ylab}{Character string for the y-axis label. Default is
\code{"Cumulative Hazard Function"}.}

\item{main.title}{Character string for the main plot title. Default is
\code{"Cox-Snell Residuals Scatterplot"}.}

\item{outlier.return}{Logical; if \code{TRUE}, potential outliers are
identified using a simple cutoff \code{|x| > 3.5}. Their
indices are printed to the console and returned invisibly. If
\code{FALSE} (default), no outlier indices are returned. Note that the
current implementation attempts to highlight outliers using additional
plotting calls and assumes access to objects named \code{Zresidual} and
\code{j} in the calling environment; users may wish to adapt this part
of the code for their own workflows.}

\item{...}{Additional arguments passed to \code{\link[survival]{plot.survfit}}
or to the underlying base graphics functions.}
}
\value{
The function is primarily called for its side-effect of producing a plot.
If \code{outlier.return = TRUE}, it prints the indices of points flagged
as outliers (\code{|x| > 3.5}) and invisibly returns a list with
component \code{outliers}, containing these indices. Otherwise, it returns
\code{NULL} invisibly.
}
\description{
Produce a Cox–Snell residual diagnostic plot for survival models, based on
the cumulative hazard of the Cox–Snell residuals. Under a correctly
specified model, the Cox–Snell residuals should follow an exponential
distribution with mean 1, so the nonparametric estimate of the cumulative
hazard should lie close to the 45-degree line.
}
\details{
The input \code{x} is typically obtained from the residual
functions in this package (e.g., \code{residual.coxph()},
\code{residual.coxph.frailty()}, or \code{residual.survreg()}) with
\code{residual.type = "Cox-Snell"}.

Non-finite Cox–Snell residuals are detected and truncated to lie slightly
beyond the largest finite residual, with a message printed to alert the
user that there may be problems with the model fit. The cumulative hazard
is drawn using \code{fun = "cumhaz"} and compared visually to the
exponential(1) reference line \eqn{H(t) = t}.
}
\examples{
\dontrun{
 library(survival)

 data(lung)
 fit <- coxph(Surv(time, status) ~ age + sex, data = lung)
 cs_resid <- residual.coxph(fit, newdata = lung,  residual.type = "Cox-Snell")

 ## Cox–Snell residual plot
 plot(cs_resid) # The user can now call plot() directly

 ## Return indices of large residuals
 out <- plot(cs_resid, outlier.return = TRUE)
 out$outliers
}
}
\seealso{
\code{residual.coxph}, \code{residual.coxph.frailty},
\code{residual.survreg}, \code{\link[survival]{Surv}},
\code{\link[survival]{survfit}}
}
