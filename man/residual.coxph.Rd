% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/residual.coxph.R
\name{residual.coxph}
\alias{residual.coxph}
\title{Residuals for Cox proportional hazards models}
\usage{
residual.coxph(
  fit_coxph,
  newdata,
  residual.type = c("censored Z-residual", "Cox-Snell", "martingale", "deviance")
)
}
\arguments{
\item{fit_coxph}{A fitted \code{\link[survival]{coxph}} model object
without a shared frailty term. The response should be a right-censored
survival object, typically \code{Surv(time, status)} or
\code{Surv(tstart, tstop, status)}.}

\item{newdata}{A \code{data.frame} containing the variables required by
\code{fit_coxph$formula}, including the \code{Surv()} response and all
covariates. Residuals are evaluated for the observations in \code{newdata}.}

\item{residual.type}{Character string specifying the type of residual to
compute. Must be one of \code{"censored Z-residual"},
\code{"Cox-Snell"}, \code{"martingale"}, or \code{"deviance"}. The
default is the full vector \code{c("censored Z-residual", "Cox-Snell",
  "martingale", "deviance")}, but in typical use a single value should be
supplied.}
}
\value{
A numeric matrix of dimension \eqn{n \times 1}, where \eqn{n} is
the number of observations in \code{newdata}. The single column is named
according to \code{residual.type}. Several attributes are attached:
\itemize{
\item \code{Survival.Prob}: vector of survival probabilities
\eqn{S_i(t_i)}.
\item \code{linear.pred}: vector of linear predictors \eqn{\eta_i}.
\item \code{covariates}: model matrix of covariates (columns used in
the linear predictor).
\item \code{censored.status}: event indicator (1 = event, 0 = censored).
\item \code{object.model.frame}: the \code{model.frame} constructed
from \code{fit_coxph$formula} and \code{newdata}.
}
}
\description{
Compute several types of residuals (censored Z-residuals, Cox–Snell,
martingale, and deviance) for Cox proportional hazards models fitted with
\code{\link[survival]{coxph}}.
}
\examples{
\dontrun{
  library(survival)

  data(lung)

  ## Cox PH model
  fit_cox <- coxph(Surv(time, status) ~ age + sex, data = lung)

  ## Censored Z-residuals
  r_z <- residual.coxph(fit_cox, newdata = lung,
                        residual.type = "censored Z-residual")

  ## Cox–Snell residuals
  r_cs <- residual.coxph(fit_cox, newdata = lung,
                         residual.type = "Cox-Snell")

  ## Martingale residuals
  r_m <- residual.coxph(fit_cox, newdata = lung,
                        residual.type = "martingale")

  ## Deviance residuals
  r_d <- residual.coxph(fit_cox, newdata = lung,
                        residual.type = "deviance")
}
}
\keyword{internal}
