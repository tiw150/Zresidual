% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Zresidual.R
\name{Zresidual}
\alias{Zresidual}
\title{Compute Z-residuals via an S3 generic}
\usage{
Zresidual(object, nrep = 1, data = NULL, type = NULL, method = "iscv", ...)
}
\arguments{
\item{object}{A fitted model object. Currently supported objects include:
\itemize{
\item \code{"coxph"} – Cox proportional hazards model (from \strong{survival})
\item \code{"survreg"} – Parametric survival regression (from \strong{survival})
\item \code{"brmsfit"} – Bayesian regression model (from \strong{brms}) with one of the
supported families listed under \strong{Details}.
}}

\item{nrep}{Integer. Number of replicated Z-residual samples to compute.
Default is \code{1}.}

\item{data}{Optional data frame used for generating model predictions and
residuals. For some models (e.g. \code{coxph} with frailty terms) this should
match the data used to fit the model.}

\item{type}{Optional character string. Residual type for hurdle and count
models (mainly used for \strong{brms} and other Bayesian/count-model
interfaces). The interpretation of this argument is model-specific.}

\item{method}{Character string indicating which predictive p-value
scheme to use when computing Z-residuals for Bayesian or simulation-based
models. Common options include \code{"iscv"} (importance-sampling
cross-validated), \code{"loocv"}, and \code{"posterior"}. The default is \code{"iscv"}.}

\item{...}{Further arguments passed on to model-specific methods
such as \code{Zresidual.coxph.survival()},
\code{Zresidual.survreg.survival()},
\code{Zresidual.poisson.brms()}, etc.}
}
\value{
An object of class \code{"zresid"} with additional class information inherited
from the model-specific method. The object contains the computed Z-residuals
and any model-specific diagnostic quantities returned by the underlying
\verb{Zresidual.*()} implementation.
}
\description{
\code{Zresidual()} is an S3 generic for computing Z-residuals for a range of
survival and regression models. It currently supports Cox proportional
hazards models (\code{coxph}) with or without frailty terms, parametric survival
regression models (\code{survreg}), and Bayesian regression models fitted with
\strong{brms} (\code{brmsfit}) for several common count and hurdle families.

The function inspects the fitted object, assigns an internal
model– and package–specific class (e.g. \code{"coxph.survival"},
\code{"survreg.survival"}, \code{"poisson.brms"}, \code{"hurdle_poisson.brms"}),
and dispatches to the corresponding \verb{Zresidual.*()} method.
}
\details{
Internally, \code{Zresidual()} modifies the class of \code{object} to encode both the
model type and the fitting package, and then uses S3 method dispatch:
\itemize{
\item For \strong{survival} models
\itemize{
\item \code{coxph} objects receive the class \code{"coxph.survival"} and are handled by
\code{Zresidual.coxph.survival()}, which further distinguishes between models
with and without frailty terms.
\item \code{survreg} objects receive the class \code{"survreg.survival"} and are handled
by \code{Zresidual.survreg.survival()}.
}
\item For \strong{brms} models
\itemize{
\item The family is obtained via \code{family(object)$family}.
\item Currently supported families include
\code{"hurdle_negbinomial"}, \code{"hurdle_poisson"},
\code{"negbinomial"}, \code{"poisson"}, and \code{"bernoulli"}.
\item Each supported family is mapped to a class of the form
\code{"<family>.brms"}, and dispatched to a method such as
\code{Zresidual.hurdle_poisson.brms()},
\code{Zresidual.negbinomial.brms()},
\code{Zresidual.poisson.brms()},
or \code{Zresidual.bernoulli.brms()}.
}
}

Additional model classes (e.g. \code{glmmTMB} fits) can be supported by defining
new S3 methods such as \code{Zresidual.poisson.glmmTMB()} and ensuring that
\code{Zresidual()} assigns the corresponding internal class
(for example \code{"poisson.glmmTMB"}).

If \code{object} does not match any supported model class, or if a \code{brmsfit}
object uses an unsupported family, \code{Zresidual()} raises an error.
}
\examples{
\dontrun{
## Cox proportional hazards model
library(survival)
fit_cox <- coxph(Surv(time, status) ~ age + sex, data = lung)
z_cox <- Zresidual(fit_cox, nrep = 10, data = lung)

## Parametric survival regression
fit_surv <- survreg(Surv(time, status) ~ age + sex,
                    data = lung, dist = "weibull")
z_surv <- Zresidual(fit_surv, nrep = 5, data = lung)

## Bayesian Poisson regression with brms
library(brms)
fit_brms <- brm(count ~ x, data = df, family = poisson)
z_brms <- Zresidual(fit_brms, method = "posterior")
}

}
\seealso{
Zresidual.coxph.survival(),
Zresidual.survreg.survival(),
Zresidual.hurdle_poisson.brms(),
Zresidual.hurdle_negbinomial.brms(),
Zresidual.negbinomial.brms(),
Zresidual.poisson.brms(),
Zresidual.bernoulli.brms(),
and related model-specific methods.
}
