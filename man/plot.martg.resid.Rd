% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.martg.resid.R
\name{plot.martg.resid}
\alias{plot.martg.resid}
\title{Plot martingale residuals for survival models}
\usage{
\method{plot}{martg.resid}(
  x,
  ylab = "Martingale Residual",
  x_axis_var = c("index", "lp", "covariate"),
  main.title = "Martingale Residual Plot",
  outlier.return = FALSE,
  ...
)
}
\arguments{
\item{x}{Numeric vector (or one-column matrix) of
martingale residuals, typically returned by one of the residual
functions in this package with \code{residual.type = "martingale"}.
It must carry the attributes \code{"censored.status"},
\code{"linear.pred"}, and \code{"covariates"} as described above.}

\item{ylab}{Character string for the y-axis label. Default is
\code{"Martingale Residual"}.}

\item{x_axis_var}{Character string controlling the x-axis. Must be one of
\code{"index"}, \code{"lp"}, \code{"covariate"}, or the name of a
covariate contained in \code{attr(x, "covariates")}.
The default is effectively \code{"lp"} if \code{x_axis_var} is not supplied.}

\item{main.title}{Character string for the main plot title. Default is
\code{"Martingale Residual Plot"}.}

\item{outlier.return}{Logical; if \code{TRUE}, attempted outliers (as
indicated by an external logical vector \code{is.outlier} in the calling
environment) are highlighted in the plot and their indices are returned
invisibly. If \code{FALSE} (default), no outlier indices are returned.
Note that this function does not compute outliers internally: it assumes
that a logical vector \code{is.outlier} of the same length as
\code{x} is available if outlier highlighting is desired.}

\item{...}{Additional arguments passed to the underlying plotting functions.}
}
\value{
The function is primarily called for its side-effect of producing a plot.
If \code{outlier.return = TRUE}, it prints the indices of outlying points
to the console and invisibly returns a list with component
\code{outliers}, containing the indices where \code{is.outlier} is
\code{TRUE}. Otherwise, it returns \code{NULL} invisibly.
}
\description{
Produce diagnostic plots for martingale residuals from survival models,
with the option to plot against the observation index, the linear predictor,
or a selected covariate. The function expects a vector (or one-column
matrix) of martingale residuals with attributes attached by the residual
computation functions in this package.
}
\details{
The input \code{x} is typically obtained from
\code{residual.coxph()}, \code{residual.coxph.frailty()}, or
\code{residual.survreg()} with \code{residual.type = "martingale"}.

The \code{x_axis_var} argument controls the x-axis:
\itemize{
 \item \code{"index"}: plot martingale residuals against observation index.
 \item \code{"lp"}: plot martingale residuals against the linear predictor
 (attribute \code{"linear.pred"}).
 \item \code{"covariate"}: prompt the user and print the available
 covariate names to the console.
 \item a character string matching one of the covariate names in
 \code{attr(x, "covariates")}: plot martingale residuals against that covariate.
}

In the \code{"lp"} and covariate cases, a LOWESS smooth is added to the
plot to highlight systematic patterns in the residuals.


Non-finite martingale residuals are detected and truncated to lie slightly
beyond the largest finite residual, with a warning message printed to alert
the user that there may be problems with the model fit. Censored and
uncensored observations are distinguished by color and plotting symbol in
all display modes.
}
\examples{
\dontrun{
library(survival)

data(lung)
fit <- coxph(Surv(time, status) ~ age + sex, data = lung)
r_m <- residual.coxph(fit, newdata = lung,
                      residual.type = "martingale")

## Basic plot vs. index
plot(r_m, x_axis_var = "index")

## Plot vs. linear predictor
plot(r_m, x_axis_var = "lp")

## Plot vs. a specific covariate, e.g. "age"
plot(r_m, x_axis_var = "age")
}
}
\seealso{
\code{residual.coxph}, \code{residual.coxph.frailty},
\code{residual.survreg}, \code{\link[survival]{Surv}},
\code{\link[survival]{survfit}}
}
