% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Zresidual.bernoulli.brms.R
\name{Zresidual_bernoulli_brms}
\alias{Zresidual_bernoulli_brms}
\title{Compute Z-residuals for a Bernoulli/Logistic brms model}
\usage{
Zresidual_bernoulli_brms(fit, method = "iscv", n.rep = 1)
}
\arguments{
\item{fit}{A fitted `brmsfit` model object with Bernoulli family.}

\item{method}{Character string specifying the residual calculation method:
`"iscv"` for importance-sampled cross-validated randomized predictive
p-values, `"rpost"` for randomized posterior predictive p-values, or
`"mpost"` for middle-value posterior predictive p-values. Default is
`"iscv"`.}

\item{n.rep}{Integer; the number of replicated Z-residual sets to
generate. Default is `1`.}

\item{data}{Optional data frame used to override the data stored inside
`fit` for prediction and diagnostic calculation. If `NULL`, the data
embedded in `fit` are used.}

\item{type}{Optional character string controlling the residual type; the
meaning is determined by the underlying implementation (if used).}

\item{...}{Further arguments passed to lower-level helpers.}
}
\value{
A numeric matrix of Z-residuals with attributes:
\itemize{
  \item \code{type}: Type of outcome (Bernoulli).
  \item \code{zero_id}: Indices of zero outcomes.
  \item \code{log_pmf}: Log-probability mass function values.
  \item \code{log_cdf}: Log-cumulative distribution function values.
  \item \code{covariates}: Model covariates.
  \item \code{linear.pred}: Linear predictor values from the fitted model.
}
}
\description{
Computes Z-residuals for a fitted Bayesian Bernoulli/Logistic (binary)
model fitted with [brms::brm()] and `family = bernoulli()`. Z-residuals
are calculated using posterior predictive methods and can be used for
model diagnostics.

This is an internal workhorse for [Zresidual.bernoulli.brms()] and is
not intended to be called directly by end users.
}
\details{
The function typically performs the following steps:
\enumerate{
  \item Extracts the observed response vector from the model data.
  \item Computes the log-PMF and log-CDF for the Bernoulli model using
        \code{\link{log_pred_dist_bern}}.
  \item Generates posterior predictive p-values according to the
        specified \code{method}.
  \item Converts the p-values to Z-residuals via the negative quantile
        of the standard normal distribution.
}

The output is a matrix of Z-residuals with one column per replication.
}
\seealso{
\code{\link{log_pred_dist_bern}}, \code{\link{post_logrpp}},
\code{\link{iscv_logrpp}},
and the S3 wrapper [Zresidual.bernoulli.brms()].
}
\keyword{internal}
