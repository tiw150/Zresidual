% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Zresidual.coxph.survival.R
\name{Zresidual_coxph_survival}
\alias{Zresidual_coxph_survival}
\title{Z-residuals for Standard Cox Models (Internal Worker)}
\usage{
Zresidual_coxph_survival(fit_coxph, newdata, n.rep = 1, ...)
}
\arguments{
\item{fit_coxph}{A fitted \code{survival::coxph} model object.}

\item{newdata}{Optional data frame on which to compute the residuals. If \code{NULL},
the original model frame is used.}

\item{n.rep}{Integer. Number of randomized residual replicates to generate. Default is 1.}

\item{...}{Additional arguments (currently unused).}
}
\value{
A matrix containing the Z-residuals (\eqn{N \times nrep}{N x nrep}) with diagnostic attributes:
\code{Survival.Prob}, \code{linear.pred}, \code{covariates}, \code{censored.status},
\code{object.model.frame}, and \code{type = "survival"}.
}
\description{
Internal function to compute randomized Z-residuals for a **standard**
Cox proportional hazards model (without frailty).
}
\details{
The Z-residual for an observation $i$ is calculated as
\deqn{Z_i = -\Phi^{-1}(\hat{S}_i(t_i, \text{rand}))}{Z\_i = -qnorm(S\_hat\_i(t\_i, rand))}
where \eqn{\Phi^{-1}}{Phi-inverse} is the inverse standard normal CDF, and \eqn{\hat{S}_i(t_i, \text{rand})}{S\_hat\_i(t\_i, rand)}
is the predicted survival probability at time \eqn{t_i}{t\_i}.

For uncensored observations (\eqn{t_i}{t\_i} is an event time), \eqn{\hat{S}_i(t_i, \text{rand}) = \hat{S}_i(t_i)}{S\_hat\_i(t\_i, rand) = S\_hat\_i(t\_i)}.
For censored observations,
\eqn{\hat{S}_i(t_i, \text{rand}) = \hat{S}_i(t_i) \cdot U}{S\_hat\_i(t\_i, rand) = S\_hat\_i(t\_i) \* U}, where \eqn{U \sim \text{Unif}(0, 1)}{U \~ Unif(0, 1)}.

The predicted survival is calculated as
\deqn{\hat{S}_i(t_i) = \exp(-\exp(\mathbf{x}_i \mathbf{\hat{\beta}}) \hat{H}_0(t_i))}{S\_hat\_i(t\_i) = exp(-exp(x\_i * beta-hat) * H\_0\_hat(t\_i))}.
}
\keyword{internal}
