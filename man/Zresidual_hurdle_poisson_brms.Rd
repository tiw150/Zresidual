% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Zresidual.hurdle.poisson.brms.R
\name{Zresidual_hurdle_poisson_brms}
\alias{Zresidual_hurdle_poisson_brms}
\title{Compute Z-residuals for hurdle or count Poisson brms models}
\usage{
Zresidual_hurdle_poisson_brms(fit, type, method = "iscv", n.rep = 1, ...)
}
\arguments{
\item{fit}{A fitted \pkg{brms} model object for a hurdle or count
Poisson outcome.}

\item{type}{Character string specifying which part of the model to
calculate Z-residuals for:
`"zero"` for the hurdle/zero portion,
`"count"` for the truncated Poisson counts,
`"hurdle"` for the full hurdle-Poisson model.}

\item{method}{Character string specifying the residual calculation method:
`"iscv"` for importance-sampled cross-validated randomized predictive
p-values, `"rpost"` for randomized posterior predictive p-values,
or `"mpost"` for middle-value posterior predictive p-values.
Default is `"iscv"`.}

\item{n.rep}{Integer; the number of replicated Z-residual sets to
generate. Default is `1`.}
}
\value{
A numeric matrix of Z-residuals with attributes such as:
\itemize{
  \item \code{type}: The requested model component.
  \item \code{zero_id}: Indices of zero outcomes.
  \item \code{log_pmf}: Log-probability mass function values.
  \item \code{log_cdf}: Log-cumulative distribution function values.
  \item \code{covariates}: Model covariates.
  \item \code{linear.pred}: Linear predictor values from the fitted model.
}
The S3 wrapper [Zresidual.hurdle_poisson.brms()] will additionally
attach the class \code{"zresid"} to the returned object.
}
\description{
Computes Z-residuals for fitted Bayesian hurdle or count models
with a Poisson distribution using a \pkg{brms} model with
`family = hurdle_poisson()`. Z-residuals can be calculated for
zeros, counts, or the overall hurdle distribution, and can be used
for model diagnostics.

This is an internal workhorse for [Zresidual.hurdle_poisson.brms()]
and is not intended to be called directly by end users.
}
\details{
A typical implementation:
\enumerate{
  \item Extracts the observed response vector from the model data.
  \item Computes the log-PMF and log-CDF for the specified part of the
        model using the corresponding \code{log_pred_dist_*} function,
        such as \code{\link{log_pred_dist_HP}} or
        \code{\link{log_pred_dist_TP}}.
  \item Generates posterior predictive p-values according to the
        specified \code{method}.
  \item Converts the p-values to Z-residuals via the negative quantile
        of the standard normal distribution.
}

The output is a matrix of Z-residuals with one column per replication.
}
\examples{
\dontrun{
  # Compute Z-residuals for counts
  zres_counts <- Zresidual_hurdle_poisson_brms(
    fit    = fit_hp,
    type   = "count",
    method = "iscv"
  )
}

}
\seealso{
\code{\link{log_pred_dist_HP}}, \code{\link{log_pred_dist_TP}},
\code{\link{post_logrpp}}, \code{\link{iscv_logrpp}},
and the S3 wrapper [Zresidual.hurdle_poisson.brms()].
}
\keyword{internal}
